/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.1
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/set-filter - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.1
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
import{_ as e,EventService as t,TextFilter as i,AgPromise as s,Autowired as l,RefSelector as r,PostConstruct as a,Component as n,ProvidedFilter as o,KeyCode as h,GROUP_AUTO_COLUMN_ID as d,Events as u,VirtualList as c,ModuleNames as p}from"@ag-grid-community/core";import{EnterpriseCoreModule as m}from"@ag-grid-enterprise/core";class v{constructor(e,t,i,s,l,r,a,n,o){this.rowModel=e,this.filterParams=t,this.createKey=i,this.caseFormat=s,this.columnModel=l,this.valueService=r,this.treeDataOrGrouping=a,this.treeData=n,this.getDataPath=o}extractUniqueValues(t,i){const s=new Map,l=this.extractExistingFormattedKeys(i),r=new Set,a=this.treeData&&!!this.getDataPath,n=this.columnModel.getRowGroupColumns(),o=(t,a)=>{const n=this.caseFormat(t);if(!r.has(n)){r.add(n);let o=t,h=e.makeNull(a);const d=null==l?void 0:l.get(n);null!=d&&(o=d,h=i.get(d)),s.set(o,h)}};return this.rowModel.forEachLeafNode(e=>{if(!e.data||!t(e))return;if(this.treeDataOrGrouping)return void this.addValueForTreeDataOrGrouping(e,a,n,o);let i=this.getValue(e);this.filterParams.convertValuesToStrings?this.addValueForConvertValuesToString(e,i,o):null!=i&&Array.isArray(i)?(i.forEach(t=>{o(this.createKey(t,e),t)}),0===i.length&&o(null,null)):o(this.createKey(i,e),i)}),s}addValueForConvertValuesToString(t,i,s){const l=this.createKey(i,t);null!=l&&Array.isArray(l)?(l.forEach(t=>{const i=e.toStringOrNull(e.makeNull(t));s(i,i)}),0===l.length&&s(null,null)):s(l,l)}addValueForTreeDataOrGrouping(t,i,s,l){var r;let a;if(i){if(null===(r=t.childrenAfterGroup)||void 0===r?void 0:r.length)return;a=this.getDataPath(t.data)}else a=s.map(e=>this.valueService.getKeyForNode(e,t)),a.push(this.getValue(t));a&&(a=a.map(t=>e.toStringOrNull(e.makeNull(t)))),(null==a?void 0:a.some(e=>null==e))&&(a=null),l(this.createKey(a),a)}getValue(e){const{api:t,colDef:i,column:s,columnApi:l,context:r}=this.filterParams;return this.filterParams.valueGetter({api:t,colDef:i,column:s,columnApi:l,context:r,data:e.data,getValue:t=>e.data[t],node:e})}extractExistingFormattedKeys(e){if(!e)return null;const t=new Map;return e.forEach((e,i)=>{t.set(this.caseFormat(i),i)}),t}}class g{}g.SELECT_ALL="__AG_SELECT_ALL__";class f{constructor(e,t,i,s){this.valueFormatterService=e,this.valueFormatter=t,this.formatter=i,this.column=s,this.displayedKeys=[]}updateDisplayedValuesToAllAvailable(e,t,i){this.displayedKeys=Array.from(i)}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,l){this.displayedKeys=[];for(let t of i)if(null==t)l&&this.displayedKeys.push(t);else{const i=e(t),l=this.valueFormatterService.formatValue(this.column,null,i,this.valueFormatter,!1);s(this.formatter(l))&&this.displayedKeys.push(t)}}getDisplayedValueCount(){return this.displayedKeys.length}getDisplayedItem(e){return this.displayedKeys[e]}getSelectAllItem(){return g.SELECT_ALL}getDisplayedKeys(){return this.displayedKeys}forEachDisplayedKey(e){this.displayedKeys.forEach(e)}someDisplayedKey(e){return this.displayedKeys.some(e)}hasGroups(){return!1}refresh(){}}class y{constructor(e,t,i,s){this.formatter=e,this.treeListPathGetter=t,this.treeListFormatter=i,this.treeDataOrGrouping=s,this.allDisplayedItemsTree=[],this.activeDisplayedItemsFlat=[],this.selectAllItem={depth:0,filterPasses:!0,available:!0,treeKey:g.SELECT_ALL,children:this.allDisplayedItemsTree,expanded:!0,key:g.SELECT_ALL,parentTreeKeys:[]}}updateDisplayedValuesToAllAvailable(e,t,i,s){"reload"===s?this.generateItemTree(e,t,i):"otherFilter"===s?(this.updateAvailable(i),this.updateExpandAll()):"miniFilter"===s&&(this.resetFilter(),this.updateExpandAll()),this.flattenItems()}updateDisplayedValuesToMatchMiniFilter(e,t,i,s,l,r){"reload"===r?this.generateItemTree(e,t,i):"otherFilter"===r&&this.updateAvailable(i),this.updateFilter(s,l),this.updateExpandAll(),this.flattenItems()}generateItemTree(e,t,i){var s;this.allDisplayedItemsTree=[],this.groupsExist=!1;const l=this.getTreeListPathGetter(e,i);for(let r of t){const t=null!==(s=l(e(r)))&&void 0!==s?s:[null];t.length>1&&(this.groupsExist=!0);const a=i.has(r);let n,o=this.allDisplayedItemsTree,h=[];t.forEach((e,i)=>{o||(o=[],n.children=o),n=o.find(t=>{var i;return(null===(i=t.treeKey)||void 0===i?void 0:i.toUpperCase())===(null==e?void 0:e.toUpperCase())}),n||(n={treeKey:e,depth:i,filterPasses:!0,expanded:!1,available:a,parentTreeKeys:h},i===t.length-1&&(n.key=r),o.push(n)),o=n.children,h=[...h,e]})}this.updateAvailable(i),this.selectAllItem.children=this.allDisplayedItemsTree,this.selectAllItem.expanded=!1}getTreeListPathGetter(t,i){if(this.treeListPathGetter)return this.treeListPathGetter;if(this.treeDataOrGrouping)return e=>e;let s=!1;for(const e of i){const i=t(e);if(i instanceof Date){s=!0;break}if(null!=i)break}return s?y.DATE_TREE_LIST_PATH_GETTER:(e.doOnce(()=>console.warn("AG Grid: property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date."),"getTreeListPathGetter"),e=>[String(e)])}flattenItems(){this.activeDisplayedItemsFlat=[];const e=t=>{t.forEach(t=>{t.filterPasses&&t.available&&(this.activeDisplayedItemsFlat.push(t),t.children&&t.expanded&&e(t.children))})};e(this.allDisplayedItemsTree)}resetFilter(){const e=t=>{t.children&&t.children.forEach(t=>{e(t)}),t.filterPasses=!0};this.allDisplayedItemsTree.forEach(t=>e(t))}updateFilter(e,t){const i=i=>!!i.available&&(null==i.treeKey?t:e(this.formatter(this.treeListFormatter?this.treeListFormatter(i.treeKey,i.depth,i.parentTreeKeys):i.treeKey)));this.allDisplayedItemsTree.forEach(e=>this.recursiveItemCheck(e,!1,i,"filterPasses"))}getDisplayedValueCount(){return this.activeDisplayedItemsFlat.length}getDisplayedItem(e){return this.activeDisplayedItemsFlat[e]}getSelectAllItem(){return this.selectAllItem}getDisplayedKeys(){const e=[];return this.forEachDisplayedKey(t=>e.push(t)),e}forEachDisplayedKey(e){const t=(i,s)=>{i.children?i.expanded&&s||i.children.forEach(e=>{e.filterPasses&&t(e,!1)}):e(i.key)};this.activeDisplayedItemsFlat.forEach(e=>t(e,!0))}someDisplayedKey(e){const t=(i,s)=>i.children?(!i.expanded||!s)&&i.children.some(e=>!!e.filterPasses&&t(e,!1)):e(i.key);return this.activeDisplayedItemsFlat.some(e=>t(e,!0))}hasGroups(){return this.groupsExist}refresh(){this.updateExpandAll(),this.flattenItems()}updateExpandAll(){const e=(t,i,s)=>{for(const l of t){if(!l.filterPasses||!l.available||!l.children)continue;if(i=i||!!l.expanded,s=s||!l.expanded,i&&s)return;const t=e(l.children,i,s);if(void 0===t)return;t?i=!0:s=!0}return i&&s?void 0:i},t=this.getSelectAllItem();t.expanded=e(t.children,!1,!1)}recursiveItemCheck(e,t,i,s){let l=!1;e.children&&e.children.forEach(r=>{const a=this.recursiveItemCheck(r,t||i(e),i,s);l=l||a});const r=t||l||i(e);return e[s]=r,r}updateAvailable(e){const t=t=>e.has(t.key);this.allDisplayedItemsTree.forEach(e=>this.recursiveItemCheck(e,!1,t,"available"))}}var F;y.DATE_TREE_LIST_PATH_GETTER=e=>e?[String(e.getFullYear()),String(e.getMonth()+1),String(e.getDate())]:null,function(e){e[e.PROVIDED_LIST=0]="PROVIDED_LIST",e[e.PROVIDED_CALLBACK=1]="PROVIDED_CALLBACK",e[e.TAKEN_FROM_GRID_VALUES=2]="TAKEN_FROM_GRID_VALUES"}(F||(F={}));class S{constructor(s){var l;this.localEventService=new t,this.miniFilterText=null,this.providedValues=null,this.allValues=new Map,this.availableKeys=new Set,this.selectedKeys=new Set,this.initialised=!1;const{usingComplexObjects:r,columnModel:a,valueService:n,treeDataTreeList:o,groupingTreeList:h,filterParams:d,gridOptionsService:u,valueFormatterService:c,valueFormatter:p}=s,{column:m,colDef:g,textFormatter:S,doesRowPassOtherFilter:E,suppressSorting:M,comparator:A,rowModel:V,values:T,caseSensitive:L,convertValuesToStrings:C,treeList:x,treeListPathGetter:w,treeListFormatter:D}=d;this.filterParams=d,this.setIsLoading=s.setIsLoading,this.translate=s.translate,this.caseFormat=s.caseFormat,this.createKey=s.createKey,this.usingComplexObjects=!!s.usingComplexObjects,this.formatter=S||i.DEFAULT_FORMATTER,this.doesRowPassOtherFilters=E,this.suppressSorting=M||!1,this.convertValuesToStrings=!!C;const b=null!=A?A:g.comparator,I=!!o||!!h;this.compareByValue=!!(r&&b||I||x&&!w),this.entryComparator=I&&!b?this.createTreeDataOrGroupingComparator():!x||w||b?([e,t],[i,s])=>b(t,s):([t,i],[s,l])=>e.defaultComparator(i,l),this.keyComparator=null!==(l=b)&&void 0!==l?l:e.defaultComparator,this.caseSensitive=!!L;const P=u.get("getDataPath");"clientSide"===V.getType()&&(this.clientSideValuesExtractor=new v(V,this.filterParams,this.createKey,this.caseFormat,a,n,I,!!o,P)),null==T?this.valuesType=F.TAKEN_FROM_GRID_VALUES:(this.valuesType=Array.isArray(T)?F.PROVIDED_LIST:F.PROVIDED_CALLBACK,this.providedValues=T),this.displayValueModel=x?new y(this.formatter,w,D,o||h):new f(c,p,this.formatter,m),this.updateAllValues().then(e=>this.resetSelectionState(e||[]))}addEventListener(e,t,i){this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService.removeEventListener(e,t,i)}refreshValues(){const e=this.getModel();return this.updateAllValues(),this.setModel(e)}overrideValues(e){return new s(t=>{this.allValuesPromise.then(()=>{this.valuesType=F.PROVIDED_LIST,this.providedValues=e,this.refreshValues().then(()=>t())})})}refreshAfterAnyFilterChanged(){return this.showAvailableOnly()?this.allValuesPromise.then(e=>(this.updateAvailableKeys(null!=e?e:[],"otherFilter"),!0)):s.resolve(!1)}isInitialised(){return this.initialised}updateAllValues(){return this.allValuesPromise=new s(e=>{switch(this.valuesType){case F.TAKEN_FROM_GRID_VALUES:case F.PROVIDED_LIST:e(this.processAllKeys(this.valuesType===F.TAKEN_FROM_GRID_VALUES,this.providedValues));break;case F.PROVIDED_CALLBACK:{this.setIsLoading(!0);const t=this.providedValues,{columnApi:i,api:s,context:l,column:r,colDef:a}=this.filterParams,n={success:t=>{this.setIsLoading(!1),e(this.processAllKeys(!1,t))},colDef:a,column:r,columnApi:i,api:s,context:l};window.setTimeout(()=>t(n),0);break}default:throw new Error("Unrecognised valuesType")}}),this.allValuesPromise.then(e=>this.updateAvailableKeys(e||[],"reload")).then(()=>this.initialised=!0),this.allValuesPromise}processAllKeys(e,t){const i=e?this.getValuesFromRows(!1):this.uniqueValues(this.validateProvidedValues(t)),s=this.sortKeys(i);return this.allValues=null!=i?i:new Map,s}validateProvidedValues(t){if(this.usingComplexObjects&&(null==t?void 0:t.length)){const i=t[0];if(i&&"object"!=typeof i&&"function"!=typeof i){null==this.createKey(i)?e.doOnce(()=>console.warn("Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects or set convertValuesToStrings=true in the filterParams. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types"),"setFilterComplexObjectsProvidedNull"):e.doOnce(()=>console.warn("AG Grid: Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects or enable convertValuesToStrings?"),"setFilterComplexObjectsProvidedPrimitive")}}return t}setValuesType(e){this.valuesType=e}getValuesType(){return this.valuesType}isKeyAvailable(e){return this.availableKeys.has(e)}showAvailableOnly(){return this.valuesType===F.TAKEN_FROM_GRID_VALUES}updateAvailableKeys(e,t){const i=this.showAvailableOnly()?this.sortKeys(this.getValuesFromRows(!0)):e;this.availableKeys=new Set(i),this.localEventService.dispatchEvent({type:S.EVENT_AVAILABLE_VALUES_CHANGED}),this.updateDisplayedValues(t,e)}sortKeys(e){const t=null!=e?e:new Map;if(this.suppressSorting)return Array.from(t.keys());let i;return i=this.compareByValue?Array.from(t.entries()).sort(this.entryComparator).map(([e])=>e):Array.from(t.keys()).sort(this.keyComparator),this.filterParams.excelMode&&t.has(null)&&(i=i.filter(e=>null!=e),i.push(null)),i}getValuesFromRows(e=!1){if(!this.clientSideValuesExtractor)return console.error("AG Grid: Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values"),null;return this.clientSideValuesExtractor.extractUniqueValues(t=>!e||this.doesRowPassOtherFilters(t),e&&!this.caseSensitive?this.allValues:void 0)}setMiniFilter(t){return t=e.makeNull(t),this.miniFilterText!==t&&(this.miniFilterText=t,this.updateDisplayedValues("miniFilter"),!0)}getMiniFilter(){return this.miniFilterText}updateDisplayedValues(e,t){if("expansion"===e)return void this.displayValueModel.refresh();if(null==this.miniFilterText)return void this.displayValueModel.updateDisplayedValuesToAllAvailable(e=>this.getValue(e),t,this.availableKeys,e);const i=this.caseFormat(this.formatter(this.miniFilterText)||""),s=e=>null!=e&&this.caseFormat(e).indexOf(i)>=0,l=!!this.filterParams.excelMode&&s(this.translate("blanks"));this.displayValueModel.updateDisplayedValuesToMatchMiniFilter(e=>this.getValue(e),t,this.availableKeys,s,l,e)}getDisplayedValueCount(){return this.displayValueModel.getDisplayedValueCount()}getDisplayedItem(e){return this.displayValueModel.getDisplayedItem(e)}getSelectAllItem(){return this.displayValueModel.getSelectAllItem()}hasSelections(){return this.filterParams.defaultToNothingSelected?this.selectedKeys.size>0:this.allValues.size!==this.selectedKeys.size}getKeys(){return Array.from(this.allValues.keys())}getValues(){return Array.from(this.allValues.values())}getValue(e){return this.allValues.get(e)}selectAllMatchingMiniFilter(e=!1){null==this.miniFilterText?this.selectedKeys=new Set(this.allValues.keys()):(e&&this.selectedKeys.clear(),this.displayValueModel.forEachDisplayedKey(e=>this.selectedKeys.add(e)))}deselectAllMatchingMiniFilter(){null==this.miniFilterText?this.selectedKeys.clear():this.displayValueModel.forEachDisplayedKey(e=>this.selectedKeys.delete(e))}selectKey(e){this.selectedKeys.add(e)}deselectKey(e){this.filterParams.excelMode&&this.isEverythingVisibleSelected()&&this.resetSelectionState(this.displayValueModel.getDisplayedKeys()),this.selectedKeys.delete(e)}isKeySelected(e){return this.selectedKeys.has(e)}isEverythingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>!this.isKeySelected(e))}isNothingVisibleSelected(){return!this.displayValueModel.someDisplayedKey(e=>this.isKeySelected(e))}getModel(){return this.hasSelections()?Array.from(this.selectedKeys):null}setModel(e){return this.allValuesPromise.then(t=>{if(null==e)this.resetSelectionState(null!=t?t:[]);else{this.selectedKeys.clear();const t=new Map;this.allValues.forEach((e,i)=>{t.set(this.caseFormat(i),i)}),e.forEach(e=>{const i=this.caseFormat(e),s=t.get(i);void 0!==s&&this.selectKey(s)})}})}uniqueValues(t){const i=new Map,s=new Set;return(null!=t?t:[]).forEach(t=>{const l=e.makeNull(t),r=this.convertAndGetKey(l),a=this.caseFormat(r);s.has(a)||(s.add(a),i.set(r,l))}),i}convertAndGetKey(e){return this.convertValuesToStrings?e:this.createKey(e)}resetSelectionState(e){this.filterParams.defaultToNothingSelected?this.selectedKeys.clear():this.selectedKeys=new Set(e)}hasGroups(){return this.displayValueModel.hasGroups()}createTreeDataOrGroupingComparator(){return([t,i],[s,l])=>{if(null==i)return null==l?0:-1;if(null==l)return 1;for(let t=0;t<i.length;t++){if(t>=l.length)return 1;const s=e.defaultComparator(i[t],l[t]);if(0!==s)return s}return 0}}}S.EVENT_AVAILABLE_VALUES_CHANGED="availableValuesChanged";var E=function(e,t,i,s){var l,r=arguments.length,a=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(a=(r<3?l(a):r>3?l(t,i,a):l(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};class M extends n{constructor(e){var t;super(e.isGroup?M.GROUP_TEMPLATE:M.TEMPLATE),this.focusWrapper=e.focusWrapper,this.value=e.value,this.params=e.params,this.translate=e.translate,this.valueFormatter=e.valueFormatter,this.item=e.item,this.isSelected=e.isSelected,this.isTree=e.isTree,this.depth=null!==(t=e.depth)&&void 0!==t?t:0,this.isGroup=e.isGroup,this.groupsExist=e.groupsExist,this.isExpanded=e.isExpanded,this.hasIndeterminateExpandState=e.hasIndeterminateExpandState}init(){this.render(),this.eCheckbox.setLabelEllipsis(!0),this.eCheckbox.setValue(this.isSelected,!0),this.eCheckbox.setDisabled(!!this.params.readOnly),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.refreshVariableAriaLabels(),this.isTree&&(this.depth>0&&this.addCssClass("ag-set-filter-indent-"+this.depth),this.isGroup?this.setupExpansion():this.groupsExist&&this.addCssClass("ag-set-filter-add-group-indent"),e.setAriaLevel(this.focusWrapper,this.depth+1)),this.params.readOnly||this.eCheckbox.onValueChange(e=>this.onCheckboxChanged(!!e))}setupExpansion(){this.eGroupClosedIcon.appendChild(e.createIcon("setFilterGroupClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(e.createIcon("setFilterGroupOpen",this.gridOptionsService,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.hasIndeterminateExpandState&&(this.eGroupIndeterminateIcon.appendChild(e.createIcon("setFilterGroupIndeterminate",this.gridOptionsService,null)),this.addManagedListener(this.eGroupIndeterminateIcon,"click",this.onExpandOrContractClicked.bind(this))),this.setExpandedIcons(),this.refreshAriaExpanded()}onExpandOrContractClicked(){this.setExpanded(!this.isExpanded)}setExpanded(e,t){if(this.isGroup&&e!==this.isExpanded){this.isExpanded=e;const i={type:M.EVENT_EXPANDED_CHANGED,isExpanded:!!e,item:this.item};t||this.dispatchEvent(i),this.setExpandedIcons(),this.refreshAriaExpanded()}}refreshAriaExpanded(){e.setAriaExpanded(this.focusWrapper,!!this.isExpanded)}setExpandedIcons(){e.setDisplayed(this.eGroupClosedIcon,this.hasIndeterminateExpandState?!1===this.isExpanded:!this.isExpanded),e.setDisplayed(this.eGroupOpenedIcon,!0===this.isExpanded),this.hasIndeterminateExpandState&&e.setDisplayed(this.eGroupIndeterminateIcon,void 0===this.isExpanded)}onCheckboxChanged(e){this.isSelected=e;const t={type:M.EVENT_SELECTION_CHANGED,isSelected:e,item:this.item};this.dispatchEvent(t),this.refreshVariableAriaLabels()}toggleSelected(){this.params.readOnly||this.setSelected(!this.isSelected)}setSelected(e,t){this.isSelected=e,this.eCheckbox.setValue(this.isSelected,t)}refreshVariableAriaLabels(){if(!this.isTree)return;const t=this.localeService.getLocaleTextFunc(),i=this.eCheckbox.getValue(),s=void 0===i?t("ariaIndeterminate","indeterminate"):i?t("ariaVisible","visible"):t("ariaHidden","hidden"),l=t("ariaToggleVisibility","Press SPACE to toggle visibility");e.setAriaLabelledBy(this.eCheckbox.getInputElement(),void 0),this.eCheckbox.setInputAriaLabel(`${l} (${s})`)}setupFixedAriaLabels(t){if(!this.isTree)return;const i=this.localeService.getLocaleTextFunc()("ariaFilterValue","Filter Value");e.setAriaLabel(this.focusWrapper,`${t} ${i}`),e.setAriaDescribedBy(this.focusWrapper,this.eCheckbox.getInputElement().id)}refresh(e,t,i){var s,l;if(this.item=e,t!==this.isSelected&&this.setSelected(t,!0),this.setExpanded(i,!0),this.valueFunction){const e=this.valueFunction();this.setTooltipAndCellRendererParams(e,e),this.cellRendererComponent||this.renderCellWithoutCellRenderer()}null===(l=null===(s=this.cellRendererComponent)||void 0===s?void 0:s.refresh)||void 0===l||l.call(s,this.cellRendererParams)}render(){const{params:{column:t}}=this;let{value:i}=this,s=null;"function"==typeof i?(this.valueFunction=i,s=this.valueFunction(),i=s):s=this.isTree?e.toStringOrNull(i):this.getFormattedValue(t,i),this.setTooltipAndCellRendererParams(i,s),this.renderCell()}setTooltipAndCellRendererParams(t,i){if(this.params.showTooltips){const s=null!=i?i:e.toStringOrNull(t);this.setTooltip(s)}this.cellRendererParams={value:t,valueFormatted:i,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context,colDef:this.params.colDef,column:this.params.column}}getTooltipParams(){const e=super.getTooltipParams();return e.location="setFilterValue",e.colDef=this.getComponentHolder(),this.isTree&&(e.level=this.depth),e}getFormattedValue(e,t){return this.valueFormatterService.formatValue(e,null,t,this.valueFormatter,!1)}renderCell(){const e=this.userComponentFactory.getSetFilterCellRendererDetails(this.params,this.cellRendererParams),t=e?e.newAgStackInstance():void 0;null!=t?t.then(e=>{e&&(this.cellRendererComponent=e,this.eCheckbox.setLabel(e.getGui()),this.addDestroyFunc(()=>this.destroyBean(e)))}):this.renderCellWithoutCellRenderer()}renderCellWithoutCellRenderer(){var t;let i=null!==(t=null==this.cellRendererParams.valueFormatted?this.cellRendererParams.value:this.cellRendererParams.valueFormatted)&&void 0!==t?t:this.translate("blanks");"string"!=typeof i&&(e.doOnce(()=>console.warn("AG Grid: Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects, or set convertValuesToStrings=true in the filterParams. See https://www.ag-grid.com/javascript-data-grid/filter-set-filter-list/#filter-value-types"),"setFilterComplexObjectsValueFormatter"),i=""),this.eCheckbox.setLabel(i),this.setupFixedAriaLabels(i)}getComponentHolder(){return this.params.column.getColDef()}}M.EVENT_SELECTION_CHANGED="selectionChanged",M.EVENT_EXPANDED_CHANGED="expandedChanged",M.GROUP_TEMPLATE='\n        <div class="ag-set-filter-item" aria-hidden="true">\n            <span class="ag-set-filter-group-icons">\n                <span class="ag-set-filter-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-set-filter-group-opened-icon" ref="eGroupOpenedIcon"></span>\n                <span class="ag-set-filter-group-indeterminate-icon" ref="eGroupIndeterminateIcon"></span>\n            </span>\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',M.TEMPLATE='\n        <div class="ag-set-filter-item">\n            <ag-checkbox ref="eCheckbox" class="ag-set-filter-item-checkbox"></ag-checkbox>\n        </div>',E([l("valueFormatterService")],M.prototype,"valueFormatterService",void 0),E([l("userComponentFactory")],M.prototype,"userComponentFactory",void 0),E([r("eCheckbox")],M.prototype,"eCheckbox",void 0),E([r("eGroupOpenedIcon")],M.prototype,"eGroupOpenedIcon",void 0),E([r("eGroupClosedIcon")],M.prototype,"eGroupClosedIcon",void 0),E([r("eGroupIndeterminateIcon")],M.prototype,"eGroupIndeterminateIcon",void 0),E([a],M.prototype,"init",null);const A={loadingOoo:"Loading...",blanks:"(Blanks)",searchOoo:"Search...",selectAll:"(Select All)",selectAllSearchResults:"(Select All Search Results)",noMatches:"No matches."};class V{getModelAsString(e,t){const{values:i}=e||t.getModel()||{},s=t.getValueModel();if(null==i||null==s)return"";const l=i.filter(e=>s.isKeyAvailable(e)),r=l.length;return`(${r}) ${l.slice(0,10).map(e=>t.getFormattedValue(e)).join(",")}${r>10?",...":""}`}}var T=function(e,t,i,s){var l,r=arguments.length,a=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(a=(r<3?l(a):r>3?l(t,i,a):l(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};class L extends o{constructor(){super("setFilter"),this.valueModel=null,this.setFilterParams=null,this.virtualList=null,this.caseSensitive=!1,this.convertValuesToStrings=!1,this.treeDataTreeList=!1,this.groupingTreeList=!1,this.hardRefreshVirtualList=!1,this.noValueFormatterSupplied=!1,this.appliedModelKeys=null,this.noAppliedModelKeys=!1,this.filterModelFormatter=new V}postConstruct(){super.postConstruct()}updateUiVisibility(){}createBodyTemplate(){return`\n            <div class="ag-set-filter">\n                <div ref="eFilterLoading" class="ag-filter-loading ag-hidden">${this.translateForSetFilter("loadingOoo")}</div>\n                <ag-input-text-field class="ag-mini-filter" ref="eMiniFilter"></ag-input-text-field>\n                <div ref="eFilterNoMatches" class="ag-filter-no-matches ag-hidden">${this.translateForSetFilter("noMatches")}</div>\n                <div ref="eSetFilterList" class="ag-set-filter-list" role="presentation"></div>\n            </div>`}handleKeyDown(e){if(super.handleKeyDown(e),!e.defaultPrevented)switch(e.key){case h.SPACE:this.handleKeySpace(e);break;case h.ENTER:this.handleKeyEnter(e);break;case h.LEFT:this.handleKeyLeft(e);break;case h.RIGHT:this.handleKeyRight(e)}}handleKeySpace(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.toggleSelected()}handleKeyEnter(e){if(!this.setFilterParams)return;const{excelMode:t,readOnly:i}=this.setFilterParams||{};t&&!i&&(e.preventDefault(),this.onBtApply(!1,!1,e),"mac"===this.setFilterParams.excelMode&&this.eMiniFilter.getInputElement().select())}handleKeyLeft(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.setExpanded(!1)}handleKeyRight(e){var t;null===(t=this.getComponentForKeyEvent(e))||void 0===t||t.setExpanded(!0)}getComponentForKeyEvent(e){var t;const i=this.gridOptionsService.getDocument();if(!this.eSetFilterList.contains(i.activeElement)||!this.virtualList)return;const s=this.virtualList.getLastFocusedRow();if(null==s)return;const l=this.virtualList.getComponentAt(s);if(null==l)return;e.preventDefault();const{readOnly:r}=null!==(t=this.setFilterParams)&&void 0!==t?t:{};return r?void 0:l}getCssIdentifier(){return"set-filter"}setModel(e){var t;return null==e&&null==(null===(t=this.valueModel)||void 0===t?void 0:t.getModel())?(this.setMiniFilter(null),s.resolve()):super.setModel(e)}setModelAndRefresh(e){return this.valueModel?this.valueModel.setModel(e).then(()=>this.refresh()):s.resolve()}resetUiToDefaults(){return this.setMiniFilter(null),this.setModelAndRefresh(null)}setModelIntoUi(e){this.setMiniFilter(null);const t=null==e?null:e.values;return this.setModelAndRefresh(t)}getModelFromUi(){if(!this.valueModel)throw new Error("Value model has not been created.");const e=this.valueModel.getModel();return e?{values:e,filterType:this.getFilterType()}:null}getFilterType(){return"set"}getValueModel(){return this.valueModel}areModelsEqual(t,i){return null==t&&null==i||null!=t&&null!=i&&e.areEqual(t.values,i.values)}setParams(e){var t;this.applyExcelModeOptions(e),super.setParams(e),this.setFilterParams=e,this.convertValuesToStrings=!!e.convertValuesToStrings,this.caseSensitive=!!e.caseSensitive;let i=null!==(t=e.keyCreator)&&void 0!==t?t:e.colDef.keyCreator;this.setValueFormatter(e.valueFormatter,i,this.convertValuesToStrings,!!e.treeList,!!e.colDef.refData);const s=e.column.getId().startsWith(d);this.treeDataTreeList=this.gridOptionsService.is("treeData")&&!!e.treeList&&s,this.getDataPath=this.gridOptionsService.get("getDataPath"),this.groupingTreeList=!!this.columnModel.getRowGroupColumns().length&&!!e.treeList&&s,this.createKey=this.generateCreateKey(i,this.convertValuesToStrings,this.treeDataTreeList||this.groupingTreeList),this.valueModel=new S({filterParams:e,setIsLoading:e=>this.setIsLoading(e),valueFormatterService:this.valueFormatterService,translate:e=>this.translateForSetFilter(e),caseFormat:e=>this.caseFormat(e),createKey:this.createKey,valueFormatter:this.valueFormatter,usingComplexObjects:!!i,gridOptionsService:this.gridOptionsService,columnModel:this.columnModel,valueService:this.valueService,treeDataTreeList:this.treeDataTreeList,groupingTreeList:this.groupingTreeList}),this.initialiseFilterBodyUi(),this.addEventListenersForDataChanges()}setValueFormatter(t,i,s,l,r){let a=t;if(!a){if(i&&!s&&!l)throw new Error("AG Grid: Must supply a Value Formatter in Set Filter params when using a Key Creator unless convertValuesToStrings is enabled");this.noValueFormatterSupplied=!0,r||(a=t=>e.toStringOrNull(t.value))}this.valueFormatter=a}generateCreateKey(t,i,s){if(s&&!t)throw new Error("AG Grid: Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.");return t?(i,s=null)=>{const l=this.getKeyCreatorParams(i,s);return e.makeNull(t(l))}:i?t=>Array.isArray(t)?t:e.makeNull(e.toStringOrNull(t)):t=>e.makeNull(e.toStringOrNull(t))}getFormattedValue(t){var i;let s=this.valueModel.getValue(t);this.noValueFormatterSupplied&&(this.treeDataTreeList||this.groupingTreeList)&&Array.isArray(s)&&(s=e.last(s));const l=this.valueFormatterService.formatValue(this.setFilterParams.column,null,s,this.valueFormatter,!1);return null!==(i=null==l?e.toStringOrNull(s):l)&&void 0!==i?i:this.translateForSetFilter("blanks")}applyExcelModeOptions(t){"windows"===t.excelMode?(t.buttons||(t.buttons=["apply","cancel"]),null==t.closeOnApply&&(t.closeOnApply=!0)):"mac"===t.excelMode&&(t.buttons||(t.buttons=["reset"]),null==t.applyMiniFilterWhileTyping&&(t.applyMiniFilterWhileTyping=!0),null==t.debounceMs&&(t.debounceMs=500)),t.excelMode&&t.defaultToNothingSelected&&(t.defaultToNothingSelected=!1,e.doOnce(()=>console.warn('AG Grid: The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.'),"setFilterExcelModeDefaultToNothingSelect"))}addEventListenersForDataChanges(){this.isValuesTakenFromGrid()&&this.addManagedListener(this.eventService,u.EVENT_CELL_VALUE_CHANGED,e=>{this.setFilterParams&&e.column===this.setFilterParams.column&&this.syncAfterDataChange()})}syncAfterDataChange(){if(!this.valueModel)throw new Error("Value model has not been created.");return this.valueModel.refreshValues().then(()=>{this.refresh(),this.onBtApply(!1,!0)})}setIsLoading(t){e.setDisplayed(this.eFilterLoading,t),t||(this.hardRefreshVirtualList=!0)}initialiseFilterBodyUi(){this.initVirtualList(),this.initMiniFilter()}initVirtualList(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const e=this.localeService.getLocaleTextFunc()("ariaFilterList","Filter List"),t=!!this.setFilterParams.treeList,i=this.virtualList=this.createBean(new c("filter",t?"tree":"listbox",e)),s=this.getRefElement("eSetFilterList");t&&s.classList.add("ag-set-filter-tree-list"),s&&s.appendChild(i.getGui());const{cellHeight:l}=this.setFilterParams;null!=l&&i.setRowHeight(l);i.setComponentCreator((e,i)=>this.createSetListItem(e,t,i));let r;i.setComponentUpdater((e,t)=>this.updateSetListItem(e,t)),r=this.setFilterParams.suppressSelectAll?new C(this.valueModel):new x(this.valueModel,()=>this.isSelectAllSelected()),t&&(r=new w(r)),i.setModel(r)}getSelectAllLabel(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const e=null!=this.valueModel.getMiniFilter()&&this.setFilterParams.excelMode?"selectAllSearchResults":"selectAll";return this.translateForSetFilter(e)}createSetListItem(e,t,i){var s,l,r,a,n,o;if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const h=this.valueModel.hasGroups();let d,u,c,p,m,v;this.isSetFilterModelTreeItem(e)?(u=e.depth,e.key===g.SELECT_ALL?(d=()=>this.getSelectAllLabel(),c=h,p=!0,m=e=>this.onSelectAll(e.isSelected),v=e=>this.onExpandAll(e.item,e.isExpanded)):e.children?(d=null!==(r=null===(l=(s=this.setFilterParams).treeListFormatter)||void 0===l?void 0:l.call(s,e.treeKey,e.depth,e.parentTreeKeys))&&void 0!==r?r:e.treeKey,c=!0,m=e=>this.onGroupItemSelected(e.item,e.isSelected),v=e=>this.onExpandedChanged(e.item,e.isExpanded)):(d=null!==(o=null===(n=(a=this.setFilterParams).treeListFormatter)||void 0===n?void 0:n.call(a,e.treeKey,e.depth,e.parentTreeKeys))&&void 0!==o?o:e.treeKey,m=e=>this.onItemSelected(e.item.key,e.isSelected))):e===g.SELECT_ALL?(d=()=>this.getSelectAllLabel(),m=e=>this.onSelectAll(e.isSelected)):(d=this.valueModel.getValue(e),m=e=>this.onItemSelected(e.item,e.isSelected));const{isSelected:f,isExpanded:y}=this.isSelectedExpanded(e),F={focusWrapper:i,value:d,params:this.setFilterParams,translate:e=>this.translateForSetFilter(e),valueFormatter:this.valueFormatter,item:e,isSelected:f,isTree:t,depth:u,groupsExist:h,isGroup:c,isExpanded:y,hasIndeterminateExpandState:p},S=this.createBean(new M(F));return S.addEventListener(M.EVENT_SELECTION_CHANGED,m),v&&S.addEventListener(M.EVENT_EXPANDED_CHANGED,v),S}updateSetListItem(e,t){const{isSelected:i,isExpanded:s}=this.isSelectedExpanded(e);t.refresh(e,i,s)}isSelectedExpanded(e){let t,i;return this.isSetFilterModelTreeItem(e)?(i=e.expanded,t=e.key===g.SELECT_ALL?this.isSelectAllSelected():e.children?this.areAllChildrenSelected(e):this.valueModel.isKeySelected(e.key)):t=e===g.SELECT_ALL?this.isSelectAllSelected():this.valueModel.isKeySelected(e),{isSelected:t,isExpanded:i}}isSetFilterModelTreeItem(e){return void 0!==(null==e?void 0:e.treeKey)}initMiniFilter(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{eMiniFilter:e,localeService:t}=this,i=t.getLocaleTextFunc();e.setDisplayed(!this.setFilterParams.suppressMiniFilter),e.setValue(this.valueModel.getMiniFilter()),e.onValueChange(()=>this.onMiniFilterInput()),e.setInputAriaLabel(i("ariaSearchFilterValues","Search filter values")),this.addManagedListener(e.getInputElement(),"keydown",e=>this.onMiniFilterKeyDown(e))}afterGuiAttached(e){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");super.afterGuiAttached(e),this.resetExpansion(),this.refreshVirtualList();const{eMiniFilter:t}=this;t.setInputPlaceholder(this.translateForSetFilter("searchOoo")),e&&e.suppressFocus||t.getFocusableElement().focus()}afterGuiDetached(){var e,t;super.afterGuiDetached(),(null===(e=this.setFilterParams)||void 0===e?void 0:e.excelMode)&&this.resetMiniFilter();const i=this.getModel();!(null===(t=this.setFilterParams)||void 0===t?void 0:t.excelMode)&&this.areModelsEqual(i,this.getModelFromUi())||(this.resetUiToActiveModel(i),this.showOrHideResults())}applyModel(e="api"){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");this.setFilterParams.excelMode&&"rowDataUpdated"!==e&&this.valueModel.isEverythingVisibleSelected()&&this.valueModel.selectAllMatchingMiniFilter();const t=super.applyModel(e),i=this.getModel();return i?(this.appliedModelKeys=new Set,i.values.forEach(e=>{this.appliedModelKeys.add(this.caseFormat(e))})):this.appliedModelKeys=null,this.noAppliedModelKeys=0===(null==i?void 0:i.values.length),t}isModelValid(e){return!this.setFilterParams||!this.setFilterParams.excelMode||(null==e||e.values.length>0)}doesFilterPass(e){if(!this.setFilterParams||!this.valueModel||!this.appliedModelKeys)return!0;if(this.noAppliedModelKeys)return!1;const{node:t,data:i}=e;if(this.treeDataTreeList)return this.doesFilterPassForTreeData(t,i);if(this.groupingTreeList)return this.doesFilterPassForGrouping(t,i);let s=this.getValueFromNode(t,i);return this.convertValuesToStrings?this.doesFilterPassForConvertValuesToString(t,s):null!=s&&Array.isArray(s)?0===s.length?this.appliedModelKeys.has(null):s.some(e=>this.isInAppliedModel(this.createKey(e,t))):this.isInAppliedModel(this.createKey(s,t))}doesFilterPassForConvertValuesToString(e,t){const i=this.createKey(t,e);return null!=i&&Array.isArray(i)?0===i.length?this.appliedModelKeys.has(null):i.some(e=>this.isInAppliedModel(e)):this.isInAppliedModel(i)}doesFilterPassForTreeData(e,t){var i;return!(null===(i=e.childrenAfterGroup)||void 0===i?void 0:i.length)&&this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(this.getDataPath(t))))}doesFilterPassForGrouping(e,t){const i=this.columnModel.getRowGroupColumns().map(t=>this.valueService.getKeyForNode(t,e));return i.push(this.getValueFromNode(e,t)),this.isInAppliedModel(this.createKey(this.checkMakeNullDataPath(i)))}checkMakeNullDataPath(t){return t&&(t=t.map(t=>e.toStringOrNull(e.makeNull(t)))),(null==t?void 0:t.some(e=>null==e))?null:t}isInAppliedModel(e){return this.appliedModelKeys.has(this.caseFormat(e))}getValueFromNode(e,t){const{valueGetter:i,api:s,colDef:l,column:r,columnApi:a,context:n}=this.setFilterParams;return i({api:s,colDef:l,column:r,columnApi:a,context:n,data:t,getValue:e=>t[e],node:e})}getKeyCreatorParams(e,t=null){return{value:e,colDef:this.setFilterParams.colDef,column:this.setFilterParams.column,node:t,data:null==t?void 0:t.data,api:this.setFilterParams.api,columnApi:this.setFilterParams.columnApi,context:this.setFilterParams.context}}onNewRowsLoaded(){this.isValuesTakenFromGrid()&&this.syncAfterDataChange()}isValuesTakenFromGrid(){if(!this.valueModel)return!1;return this.valueModel.getValuesType()===F.TAKEN_FROM_GRID_VALUES}setFilterValues(e){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.overrideValues(e).then(()=>{this.refresh(),this.onUiChanged()})}resetFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.setValuesType(F.TAKEN_FROM_GRID_VALUES),this.syncAfterDataChange()}refreshFilterValues(){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.isInitialised()&&this.valueModel.refreshValues().then(()=>{this.refresh(),this.onUiChanged()})}onAnyFilterChanged(){setTimeout(()=>{if(this.isAlive()){if(!this.valueModel)throw new Error("Value model has not been created.");this.valueModel.refreshAfterAnyFilterChanged().then(e=>{e&&(this.refresh(),this.showOrHideResults())})}},0)}onMiniFilterInput(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.valueModel.setMiniFilter(this.eMiniFilter.getValue()))return;const{applyMiniFilterWhileTyping:e,readOnly:t}=this.setFilterParams||{};!t&&e?this.filterOnAllVisibleValues(!1):this.updateUiAfterMiniFilterChange()}updateUiAfterMiniFilterChange(){if(!this.setFilterParams)throw new Error("Set filter params have not been provided.");if(!this.valueModel)throw new Error("Value model has not been created.");const{excelMode:e,readOnly:t}=this.setFilterParams||{};null==e||t?this.refresh():null==this.valueModel.getMiniFilter()?this.resetUiToActiveModel(this.getModel()):(this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged()),this.showOrHideResults()}showOrHideResults(){if(!this.valueModel)throw new Error("Value model has not been created.");const t=null!=this.valueModel.getMiniFilter()&&this.valueModel.getDisplayedValueCount()<1;e.setDisplayed(this.eNoMatches,t),e.setDisplayed(this.eSetFilterList,!t)}resetMiniFilter(){var e;this.eMiniFilter.setValue(null,!0),null===(e=this.valueModel)||void 0===e||e.setMiniFilter(null)}resetUiToActiveModel(e,t){this.setModelAndRefresh(null==e?null:e.values).then(()=>{this.onUiChanged(!1,"prevent"),null==t||t()})}handleCancelEnd(e){this.setMiniFilter(null),super.handleCancelEnd(e)}onMiniFilterKeyDown(e){const{excelMode:t,readOnly:i}=this.setFilterParams||{};e.key!==h.ENTER||t||i||this.filterOnAllVisibleValues()}filterOnAllVisibleValues(e=!0){const{readOnly:t}=this.setFilterParams||{};if(!this.valueModel)throw new Error("Value model has not been created.");if(t)throw new Error("Unable to filter in readOnly mode.");this.valueModel.selectAllMatchingMiniFilter(!0),this.refresh(),this.onUiChanged(!1,e?"immediately":"debounce"),this.showOrHideResults()}focusRowIfAlive(e){null!=e&&window.setTimeout(()=>{if(!this.virtualList)throw new Error("Virtual list has not been created.");this.isAlive()&&this.virtualList.focusRow(e)},0)}onSelectAll(e){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");e?this.valueModel.selectAllMatchingMiniFilter():this.valueModel.deselectAllMatchingMiniFilter(),this.refreshAfterSelection()}onGroupItemSelected(e,t){const i=e=>{e.children?e.children.forEach(e=>i(e)):this.selectItem(e.key,t)};i(e),this.refreshAfterSelection()}onItemSelected(e,t){if(!this.valueModel)throw new Error("Value model has not been created.");if(!this.virtualList)throw new Error("Virtual list has not been created.");this.selectItem(e,t),this.refreshAfterSelection()}selectItem(e,t){t?this.valueModel.selectKey(e):this.valueModel.deselectKey(e)}onExpandAll(e,t){const i=e=>{e.filterPasses&&e.available&&e.children&&(e.children.forEach(e=>i(e)),e.expanded=t)};i(e),this.refreshAfterExpansion()}onExpandedChanged(e,t){e.expanded=t,this.refreshAfterExpansion()}refreshAfterExpansion(){const e=this.virtualList.getLastFocusedRow();this.valueModel.updateDisplayedValues("expansion"),this.refresh(),this.focusRowIfAlive(e)}refreshAfterSelection(){const e=this.virtualList.getLastFocusedRow();this.refresh(),this.onUiChanged(),this.focusRowIfAlive(e)}setMiniFilter(e){this.eMiniFilter.setValue(e),this.onMiniFilterInput()}getMiniFilter(){return this.valueModel?this.valueModel.getMiniFilter():null}refresh(){if(!this.virtualList)throw new Error("Virtual list has not been created.");this.virtualList.refresh(!this.hardRefreshVirtualList),this.hardRefreshVirtualList&&(this.hardRefreshVirtualList=!1)}getFilterKeys(){return this.valueModel?this.valueModel.getKeys():[]}getFilterValues(){return this.valueModel?this.valueModel.getValues():[]}getValues(){return this.getFilterKeys()}refreshVirtualList(){this.setFilterParams&&this.setFilterParams.refreshValuesOnOpen?this.refreshFilterValues():this.refresh()}translateForSetFilter(e){return this.localeService.getLocaleTextFunc()(e,A[e])}isSelectAllSelected(){if(!this.setFilterParams||!this.valueModel)return!1;if(this.setFilterParams.defaultToNothingSelected){if(this.valueModel.hasSelections()&&this.valueModel.isEverythingVisibleSelected())return!0;if(this.valueModel.isNothingVisibleSelected())return!1}else{if(this.valueModel.hasSelections()&&this.valueModel.isNothingVisibleSelected())return!1;if(this.valueModel.isEverythingVisibleSelected())return!0}}areAllChildrenSelected(e){const t=e=>{if(e.children){let i=!1,s=!1;return e.children.some(e=>{if(!e.filterPasses||!e.available)return!1;const l=t(e);return void 0===l||(l?i=!0:s=!0,i&&s)})?void 0:i}return this.valueModel.isKeySelected(e.key)};return this.setFilterParams.defaultToNothingSelected?this.valueModel.hasSelections()&&t(e):t(e)}destroy(){null!=this.virtualList&&(this.virtualList.destroy(),this.virtualList=null),super.destroy()}caseFormat(e){return null==e||"string"!=typeof e||this.caseSensitive?e:e.toUpperCase()}resetExpansion(){var e,t;if(!(null===(e=this.setFilterParams)||void 0===e?void 0:e.treeList))return;const i=null===(t=this.valueModel)||void 0===t?void 0:t.getSelectAllItem();if(this.isSetFilterModelTreeItem(i)){const e=t=>{t.children&&(t.children.forEach(t=>e(t)),t.expanded=!1)};e(i),this.valueModel.updateDisplayedValues("expansion")}}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e,this)}getPositionableElement(){return this.eSetFilterList}}T([r("eMiniFilter")],L.prototype,"eMiniFilter",void 0),T([r("eFilterLoading")],L.prototype,"eFilterLoading",void 0),T([r("eSetFilterList")],L.prototype,"eSetFilterList",void 0),T([r("eFilterNoMatches")],L.prototype,"eNoMatches",void 0),T([l("valueFormatterService")],L.prototype,"valueFormatterService",void 0),T([l("columnModel")],L.prototype,"columnModel",void 0),T([l("valueService")],L.prototype,"valueService",void 0);class C{constructor(e){this.model=e}getRowCount(){return this.model.getDisplayedValueCount()}getRow(e){return this.model.getDisplayedItem(e)}isRowSelected(e){return this.model.isKeySelected(this.getRow(e))}areRowsEqual(e,t){return e===t}}class x{constructor(e,t){this.model=e,this.isSelectAllSelected=t}getRowCount(){return this.model.getDisplayedValueCount()+1}getRow(e){return 0===e?this.model.getSelectAllItem():this.model.getDisplayedItem(e-1)}isRowSelected(e){return 0===e?this.isSelectAllSelected():this.model.isKeySelected(this.getRow(e))}areRowsEqual(e,t){return e===t}}class w{constructor(e){this.model=e}getRowCount(){return this.model.getRowCount()}getRow(e){return this.model.getRow(e)}areRowsEqual(e,t){return null==e&&null==t||null!=e&&null!=t&&e.treeKey===t.treeKey&&e.depth===t.depth}}var D=function(e,t,i,s){var l,r=arguments.length,a=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(a=(r<3?l(a):r>3?l(t,i,a):l(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};class b extends n{constructor(){super('\n            <div class="ag-floating-filter-input ag-set-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>'),this.availableValuesListenerAdded=!1,this.filterModelFormatter=new V}destroy(){super.destroy()}init(e){const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${i("ariaFilterInput","Filter Input")}`).addGuiEventListener("click",()=>e.showParentFilter()),this.params=e}onParentModelChanged(e){this.updateFloatingFilterText(e)}parentSetFilterInstance(e){this.params.parentFilterInstance(t=>{if(!(t instanceof L))throw new Error("AG Grid - SetFloatingFilter expects SetFilter as its parent");e(t)})}addAvailableValuesListener(){this.parentSetFilterInstance(e=>{const t=e.getValueModel();t&&this.addManagedListener(t,S.EVENT_AVAILABLE_VALUES_CHANGED,()=>this.updateFloatingFilterText())}),this.availableValuesListenerAdded=!0}updateFloatingFilterText(e){this.availableValuesListenerAdded||this.addAvailableValuesListener(),this.parentSetFilterInstance(t=>{this.eFloatingFilterText.setValue(this.filterModelFormatter.getModelAsString(e,t))})}}D([r("eFloatingFilterText")],b.prototype,"eFloatingFilterText",void 0),D([l("columnModel")],b.prototype,"columnModel",void 0);const I={version:"30.0.1",moduleName:p.SetFilterModule,beans:[],userComponents:[{componentName:"agSetColumnFilter",componentClass:L},{componentName:"agSetColumnFloatingFilter",componentClass:b}],dependantModules:[m]};export{L as SetFilter,I as SetFilterModule};