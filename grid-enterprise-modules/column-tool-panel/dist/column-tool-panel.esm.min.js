/**
          * @ag-grid-enterprise/column-tool-panel - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.1
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/column-tool-panel - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.1
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
import{Autowired as e,RefSelector as t,PostConstruct as s,Component as i,KeyCode as o,Events as n,_ as l,EventService as a,Column as r,ProvidedColumnGroup as d,AgMenuList as c,AgMenuItemComponent as h,AgCheckbox as u,CssClassApplier as p,DragSourceType as m,DragAndDropService as g,TouchListener as C,BeanStub as v,AutoScrollService as E,PreDestroy as y,VirtualList as f,PreConstruct as D,PositionableFeature as S,ModuleRegistry as L,ModuleNames as P,Bean as A}from"@ag-grid-community/core";import{EnterpriseCoreModule as b}from"@ag-grid-enterprise/core";import{RowGroupDropZonePanel as M,ValuesDropZonePanel as T,PivotDropZonePanel as N,RowGroupingModule as G}from"@ag-grid-enterprise/row-grouping";import{SideBarModule as I}from"@ag-grid-enterprise/side-bar";var x,O=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};!function(e){e[e.EXPANDED=0]="EXPANDED",e[e.COLLAPSED=1]="COLLAPSED",e[e.INDETERMINATE=2]="INDETERMINATE"}(x||(x={}));class w extends i{constructor(){super(w.TEMPLATE)}postConstruct(){this.createExpandIcons(),this.addManagedListener(this.eExpand,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eExpand,"keydown",e=>{e.key===o.SPACE&&(e.preventDefault(),this.onExpandClicked())}),this.addManagedListener(this.eSelect.getInputElement(),"click",this.onSelectClicked.bind(this)),this.eFilterTextField.onValueChange(()=>this.onFilterTextChanged()),this.addManagedListener(this.eFilterTextField.getInputElement(),"keydown",this.onMiniFilterKeyDown.bind(this)),this.addManagedListener(this.eventService,n.EVENT_NEW_COLUMNS_LOADED,this.showOrHideOptions.bind(this));const e=this.localeService.getLocaleTextFunc();this.eSelect.setInputAriaLabel(e("ariaColumnSelectAll","Toggle Select All Columns")),this.eFilterTextField.setInputAriaLabel(e("ariaFilterColumnsInput","Filter Columns Input"))}init(e){this.params=e,this.columnModel.isReady()&&this.showOrHideOptions()}createExpandIcons(){this.eExpand.appendChild(this.eExpandChecked=l.createIconNoSpan("columnSelectOpen",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandUnchecked=l.createIconNoSpan("columnSelectClosed",this.gridOptionsService)),this.eExpand.appendChild(this.eExpandIndeterminate=l.createIconNoSpan("columnSelectIndeterminate",this.gridOptionsService)),this.setExpandState(x.EXPANDED)}showOrHideOptions(){const e=!this.params.suppressColumnFilter,t=!this.params.suppressColumnSelectAll,s=!this.params.suppressColumnExpandAll,i=this.columnModel.isPrimaryColumnGroupsPresent(),o=this.localeService.getLocaleTextFunc();this.eFilterTextField.setInputPlaceholder(o("searchOoo","Search...")),l.setDisplayed(this.eFilterTextField.getGui(),e),l.setDisplayed(this.eSelect.getGui(),t),l.setDisplayed(this.eExpand,s&&i)}onFilterTextChanged(){this.onFilterTextChangedDebounced||(this.onFilterTextChangedDebounced=l.debounce(()=>{const e=this.eFilterTextField.getValue();this.dispatchEvent({type:"filterChanged",filterText:e})},w.DEBOUNCE_DELAY)),this.onFilterTextChangedDebounced()}onMiniFilterKeyDown(e){e.key===o.ENTER&&setTimeout(()=>this.onSelectClicked(),w.DEBOUNCE_DELAY)}onSelectClicked(){this.dispatchEvent({type:this.selectState?"unselectAll":"selectAll"})}onExpandClicked(){this.dispatchEvent({type:this.expandState===x.EXPANDED?"collapseAll":"expandAll"})}setExpandState(e){this.expandState=e,l.setDisplayed(this.eExpandChecked,this.expandState===x.EXPANDED),l.setDisplayed(this.eExpandUnchecked,this.expandState===x.COLLAPSED),l.setDisplayed(this.eExpandIndeterminate,this.expandState===x.INDETERMINATE)}setSelectionState(e){this.selectState=e,this.eSelect.setValue(this.selectState)}}w.DEBOUNCE_DELAY=300,w.TEMPLATE='<div class="ag-column-select-header" role="presentation">\n            <div ref="eExpand" class="ag-column-select-header-icon" tabindex="0"></div>\n            <ag-checkbox ref="eSelect" class="ag-column-select-header-checkbox"></ag-checkbox>\n            <ag-input-text-field class="ag-column-select-header-filter-wrapper" ref="eFilterTextField"></ag-input-text-field>\n        </div>',O([e("columnModel")],w.prototype,"columnModel",void 0),O([t("eExpand")],w.prototype,"eExpand",void 0),O([t("eSelect")],w.prototype,"eSelect",void 0),O([t("eFilterTextField")],w.prototype,"eFilterTextField",void 0),O([s],w.prototype,"postConstruct",null);class _{constructor(e,t,s,i=!1,o){this.eventService=new a,this.displayName=e,this.dept=s,this.group=i,i?(this.columnGroup=t,this.expanded=o,this.children=[]):this.column=t}isGroup(){return this.group}getDisplayName(){return this.displayName}getColumnGroup(){return this.columnGroup}getColumn(){return this.column}getDept(){return this.dept}isExpanded(){return!!this.expanded}getChildren(){return this.children}isPassesFilter(){return this.passesFilter}setExpanded(e){e!==this.expanded&&(this.expanded=e,this.eventService.dispatchEvent({type:_.EVENT_EXPANDED_CHANGED}))}setPassesFilter(e){this.passesFilter=e}addEventListener(e,t){this.eventService.addEventListener(e,t)}removeEventListener(e,t){this.eventService.removeEventListener(e,t)}}_.EVENT_EXPANDED_CHANGED="expandedChanged";var F=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class V extends i{constructor(e,t,s){super('<div class="ag-menu"></div>'),this.column=e,this.mouseEvent=t,this.parentEl=s,this.displayName=null}postConstruct(){this.initializeProperties(this.column),this.buildMenuItemMap(),this.column instanceof r?this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnToolPanel"):this.displayName=this.columnModel.getDisplayNameForProvidedColumnGroup(null,this.column,"columnToolPanel"),this.isActive()&&(this.mouseEvent.preventDefault(),this.displayContextMenu())}initializeProperties(e){this.columns=e instanceof d?e.getLeafColumns():[e],this.allowGrouping=this.columns.some(e=>e.isPrimary()&&e.isAllowRowGroup()),this.allowValues=this.columns.some(e=>e.isPrimary()&&e.isAllowValue()),this.allowPivoting=this.columnModel.isPivotMode()&&this.columns.some(e=>e.isPrimary()&&e.isAllowPivot())}buildMenuItemMap(){const e=this.localeService.getLocaleTextFunc();this.menuItemMap=new Map,this.menuItemMap.set("rowGroup",{allowedFunction:e=>e.isPrimary()&&e.isAllowRowGroup(),activeFunction:e=>e.isRowGroupActive(),activateLabel:()=>`${e("groupBy","Group by")} ${this.displayName}`,deactivateLabel:()=>`${e("ungroupBy","Un-Group by")} ${this.displayName}`,activateFunction:()=>{const e=this.columnModel.getRowGroupColumns();this.columnModel.setRowGroupColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getRowGroupColumns();this.columnModel.setRowGroupColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"menuAddRowGroup",removeIcon:"menuRemoveRowGroup"}),this.menuItemMap.set("value",{allowedFunction:e=>e.isPrimary()&&e.isAllowValue(),activeFunction:e=>e.isValueActive(),activateLabel:()=>e("addToValues",`Add ${this.displayName} to values`,[this.displayName]),deactivateLabel:()=>e("removeFromValues",`Remove ${this.displayName} from values`,[this.displayName]),activateFunction:()=>{const e=this.columnModel.getValueColumns();this.columnModel.setValueColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getValueColumns();this.columnModel.setValueColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"valuePanel",removeIcon:"valuePanel"}),this.menuItemMap.set("pivot",{allowedFunction:e=>this.columnModel.isPivotMode()&&e.isPrimary()&&e.isAllowPivot(),activeFunction:e=>e.isPivotActive(),activateLabel:()=>e("addToLabels",`Add ${this.displayName} to labels`,[this.displayName]),deactivateLabel:()=>e("removeFromLabels",`Remove ${this.displayName} from labels`,[this.displayName]),activateFunction:()=>{const e=this.columnModel.getPivotColumns();this.columnModel.setPivotColumns(this.addColumnsToList(e),"toolPanelUi")},deActivateFunction:()=>{const e=this.columnModel.getPivotColumns();this.columnModel.setPivotColumns(this.removeColumnsFromList(e),"toolPanelUi")},addIcon:"pivotPanel",removeIcon:"pivotPanel"})}addColumnsToList(e){return[...e].concat(this.columns.filter(t=>-1===e.indexOf(t)))}removeColumnsFromList(e){return e.filter(e=>-1===this.columns.indexOf(e))}displayContextMenu(){const e=this.getGui(),t=this.createBean(new c),s=this.getMappedMenuItems(),i=this.localeService.getLocaleTextFunc();let o=()=>{};e.appendChild(t.getGui()),t.addMenuItems(s),t.addManagedListener(t,h.EVENT_MENU_ITEM_SELECTED,()=>{this.parentEl.focus(),o()});const n=this.popupService.addPopup({modal:!0,eChild:e,closeOnEsc:!0,afterGuiAttached:()=>this.focusService.focusInto(t.getGui()),ariaLabel:i("ariaLabelContextMenu","Context Menu"),closedCallback:e=>{e instanceof KeyboardEvent&&this.parentEl.focus(),this.destroyBean(t)}});n&&(o=n.hideFunc),this.popupService.positionPopupUnderMouseEvent({type:"columnContextMenu",mouseEvent:this.mouseEvent,ePopup:e})}isActive(){return this.allowGrouping||this.allowValues||this.allowPivoting}getMappedMenuItems(){const e=[];for(const t of this.menuItemMap.values()){const s=this.columns.some(e=>t.allowedFunction(e)&&!t.activeFunction(e)),i=this.columns.some(e=>t.allowedFunction(e)&&t.activeFunction(e));s&&e.push({name:t.activateLabel(this.displayName),icon:l.createIconNoSpan(t.addIcon,this.gridOptionsService,null),action:()=>t.activateFunction()}),i&&e.push({name:t.deactivateLabel(this.displayName),icon:l.createIconNoSpan(t.removeIcon,this.gridOptionsService,null),action:()=>t.deActivateFunction()})}return e}}F([e("columnModel")],V.prototype,"columnModel",void 0),F([e("popupService")],V.prototype,"popupService",void 0),F([e("focusService")],V.prototype,"focusService",void 0),F([s],V.prototype,"postConstruct",null);var R=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class H extends i{constructor(e,t,s,i){super(),this.modelItem=e,this.allowDragging=t,this.eventType=s,this.focusWrapper=i,this.processingColumnStateChange=!1,this.modelItem=e,this.columnGroup=e.getColumnGroup(),this.columnDept=e.getDept(),this.allowDragging=t}init(){this.setTemplate(H.TEMPLATE),this.eDragHandle=l.createIconNoSpan("columnDrag",this.gridOptionsService),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-group-drag-handle");const e=this.cbSelect.getGui(),t=this.cbSelect.getInputElement();e.insertAdjacentElement("afterend",this.eDragHandle),t.setAttribute("tabindex","-1"),this.displayName=this.columnModel.getDisplayNameForProvidedColumnGroup(null,this.columnGroup,this.eventType),l.missing(this.displayName)&&(this.displayName=">>"),this.eLabel.innerHTML=this.displayName?this.displayName:"",this.setupExpandContract(),this.addCssClass("ag-column-select-indent-"+this.columnDept),this.addManagedListener(this.eventService,n.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.addManagedListener(this.cbSelect,u.EVENT_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.modelItem,_.EVENT_EXPANDED_CHANGED,this.onExpandChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.setOpenClosedIcons(),this.setupDragging(),this.onColumnStateChanged(),this.addVisibilityListenersToAllChildren(),this.refreshAriaExpanded(),this.refreshAriaLabel(),this.setupTooltip();p.getToolPanelClassesFromColDef(this.columnGroup.getColGroupDef(),this.gridOptionsService,null,this.columnGroup).forEach(e=>this.addOrRemoveCssClass(e,!0))}getColumns(){return this.columnGroup.getLeafColumns()}setupTooltip(){const e=this.columnGroup.getColGroupDef();if(!e)return;const t=()=>{const t=e.headerTooltip;this.setTooltip(t)};t(),this.addManagedListener(this.eventService,n.EVENT_NEW_COLUMNS_LOADED,t)}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumnGroup",e}handleKeyDown(e){switch(e.key){case o.LEFT:e.preventDefault(),this.modelItem.setExpanded(!1);break;case o.RIGHT:e.preventDefault(),this.modelItem.setExpanded(!0);break;case o.SPACE:e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected())}}onContextMenu(e){const{columnGroup:t,gridOptionsService:s}=this;if(s.is("functionsReadOnly"))return;const i=this.createBean(new V(t,e,this.focusWrapper));this.addDestroyFunc(()=>{i.isAlive()&&this.destroyBean(i)})}addVisibilityListenersToAllChildren(){this.columnGroup.getLeafColumns().forEach(e=>{this.addManagedListener(e,r.EVENT_VISIBLE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,r.EVENT_VALUE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,r.EVENT_PIVOT_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(e,r.EVENT_ROW_GROUP_CHANGED,this.onColumnStateChanged.bind(this))})}setupDragging(){if(!this.allowDragging)return void l.setDisplayed(this.eDragHandle,!1);const e=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),t={type:m.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,defaultIconName:e?g.ICON_HIDE:g.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),onDragStarted:()=>{const e={type:n.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:this.columnGroup};this.eventService.dispatchEvent(e)},onDragStopped:()=>{const e={type:n.EVENT_COLUMN_PANEL_ITEM_DRAG_END};this.eventService.dispatchEvent(e)},onGridEnter:()=>{e&&this.onChangeCommon(!0)},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(t))}createDragItem(){const e={};return this.columnGroup.getLeafColumns().forEach(t=>{e[t.getId()]=t.isVisible()}),{columns:this.columnGroup.getLeafColumns(),visibleState:e}}setupExpandContract(){this.eGroupClosedIcon.appendChild(l.createIcon("columnSelectClosed",this.gridOptionsService,null)),this.eGroupOpenedIcon.appendChild(l.createIcon("columnSelectOpen",this.gridOptionsService,null)),this.addManagedListener(this.eGroupClosedIcon,"click",this.onExpandOrContractClicked.bind(this)),this.addManagedListener(this.eGroupOpenedIcon,"click",this.onExpandOrContractClicked.bind(this));const e=new C(this.eColumnGroupIcons,!0);this.addManagedListener(e,C.EVENT_TAP,this.onExpandOrContractClicked.bind(this)),this.addDestroyFunc(e.destroy.bind(e))}onLabelClicked(){const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}getVisibleLeafColumns(){const e=[],t=s=>{s.forEach(s=>{s.isPassesFilter()&&(s.isGroup()?t(s.getChildren()):e.push(s.getColumn()))})};return t(this.modelItem.getChildren()),e}onChangeCommon(e){this.refreshAriaLabel(),this.processingColumnStateChange||this.modelItemUtils.selectAllChildren(this.modelItem.getChildren(),e,this.eventType)}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumnGroup","Column Group"),s=this.cbSelect.getValue(),i=void 0===s?e("ariaIndeterminate","indeterminate"):s?e("ariaVisible","visible"):e("ariaHidden","hidden"),o=e("ariaToggleVisibility","Press SPACE to toggle visibility");l.setAriaLabel(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${o} (${i})`),l.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)}onColumnStateChanged(){const e=this.workOutSelectedValue(),t=this.workOutReadOnlyValue();this.processingColumnStateChange=!0,this.cbSelect.setValue(e),this.cbSelect.setReadOnly(t),this.addOrRemoveCssClass("ag-column-select-column-group-readonly",t),this.processingColumnStateChange=!1}workOutSelectedValue(){const e=this.columnModel.isPivotMode(),t=this.getVisibleLeafColumns();let s=0,i=0;if(t.forEach(t=>{!e&&t.getColDef().lockVisible||(this.isColumnChecked(t,e)?s++:i++)}),!(s>0&&i>0))return s>0}workOutReadOnlyValue(){const e=this.columnModel.isPivotMode();let t=0;return this.columnGroup.getLeafColumns().forEach(s=>{e?s.isAnyFunctionAllowed()&&t++:s.getColDef().lockVisible||t++}),0===t}isColumnChecked(e,t){if(t){const t=e.isPivotActive(),s=e.isRowGroupActive(),i=e.isValueActive();return t||s||i}return e.isVisible()}onExpandOrContractClicked(){const e=this.modelItem.isExpanded();this.modelItem.setExpanded(!e)}onExpandChanged(){this.setOpenClosedIcons(),this.refreshAriaExpanded()}setOpenClosedIcons(){const e=this.modelItem.isExpanded();l.setDisplayed(this.eGroupClosedIcon,!e),l.setDisplayed(this.eGroupOpenedIcon,e)}refreshAriaExpanded(){l.setAriaExpanded(this.focusWrapper,this.modelItem.isExpanded())}getDisplayName(){return this.displayName}onSelectAllChanged(e){const t=this.cbSelect.getValue();!this.cbSelect.isReadOnly()&&(e&&!t||!e&&t)&&this.cbSelect.toggle()}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}setSelected(e){this.cbSelect.setValue(e,!0)}}H.TEMPLATE='<div class="ag-column-select-column-group" aria-hidden="true">\n            <span class="ag-column-group-icons" ref="eColumnGroupIcons" >\n                <span class="ag-column-group-closed-icon" ref="eGroupClosedIcon"></span>\n                <span class="ag-column-group-opened-icon" ref="eGroupOpenedIcon"></span>\n            </span>\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',R([e("columnModel")],H.prototype,"columnModel",void 0),R([e("dragAndDropService")],H.prototype,"dragAndDropService",void 0),R([e("modelItemUtils")],H.prototype,"modelItemUtils",void 0),R([t("cbSelect")],H.prototype,"cbSelect",void 0),R([t("eLabel")],H.prototype,"eLabel",void 0),R([t("eGroupOpenedIcon")],H.prototype,"eGroupOpenedIcon",void 0),R([t("eGroupClosedIcon")],H.prototype,"eGroupClosedIcon",void 0),R([t("eColumnGroupIcons")],H.prototype,"eColumnGroupIcons",void 0),R([s],H.prototype,"init",null);var k=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};const U="ag-list-item-hovered";class B extends v{constructor(e,t){super(),this.comp=e,this.virtualList=t,this.currentDragColumn=null,this.lastHoveredColumnItem=null}postConstruct(){this.addManagedListener(this.eventService,n.EVENT_COLUMN_PANEL_ITEM_DRAG_START,this.columnPanelItemDragStart.bind(this)),this.addManagedListener(this.eventService,n.EVENT_COLUMN_PANEL_ITEM_DRAG_END,this.columnPanelItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}columnPanelItemDragStart({column:e}){this.currentDragColumn=e;this.getCurrentColumns().find(e=>{const t=e.getColDef();return!!t.suppressMovable||!!t.lockPosition})&&(this.moveBlocked=!0)}columnPanelItemDragEnd(){window.setTimeout(()=>{this.currentDragColumn=null,this.moveBlocked=!1},10)}createDropTarget(){const e={isInterestedIn:e=>e===m.ToolPanel,getIconName:()=>g[this.moveBlocked?"ICON_NOT_ALLOWED":"ICON_MOVE"],getContainer:()=>this.comp.getGui(),onDragging:e=>this.onDragging(e),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(e)}createAutoScrollService(){const e=this.virtualList.getGui();this.autoScrollService=new E({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}onDragging(e){if(!this.currentDragColumn||this.moveBlocked)return;const t=this.getDragColumnItem(e),s=this.virtualList.getComponentAt(t.rowIndex);if(!s)return;const i=s.getGui().parentElement;this.lastHoveredColumnItem&&this.lastHoveredColumnItem.rowIndex===t.rowIndex&&this.lastHoveredColumnItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredColumnItem=t,l.radioCssClass(i,""+U),l.radioCssClass(i,"ag-item-highlight-"+t.position))}getDragColumnItem(e){const t=this.virtualList.getGui(),s=parseFloat(window.getComputedStyle(t).paddingTop),i=this.virtualList.getRowHeight(),o=this.virtualList.getScrollTop(),n=Math.max(0,(e.y-s+o)/i),l=this.comp.getDisplayedColsList().length-1,a=0|Math.min(l,n);return{rowIndex:a,position:Math.round(n)>n||n>l?"bottom":"top",component:this.virtualList.getComponentAt(a)}}onDragStop(){if(this.moveBlocked)return;const e=this.getTargetIndex(),t=this.getCurrentColumns();null!=e&&this.columnModel.moveColumns(t,e,"toolPanelUi"),this.clearHoveredItems(),this.autoScrollService.ensureCleared()}getMoveDiff(e){const t=this.columnModel.getAllGridColumns(),s=this.getCurrentColumns(),i=s[0],o=s.length;return t.indexOf(i)<e?o:0}getCurrentColumns(){return this.currentDragColumn instanceof d?this.currentDragColumn.getLeafColumns():[this.currentDragColumn]}getTargetIndex(){if(!this.lastHoveredColumnItem)return null;const e=this.lastHoveredColumnItem.component;let t,s="top"===this.lastHoveredColumnItem.position;if(e instanceof H){t=e.getColumns()[0],s=!0}else t=e.getColumn();const i=this.columnModel.getAllGridColumns().indexOf(t),o=s?i:i+1;return o-this.getMoveDiff(o)}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll("."+U).forEach(e=>{[U,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(t=>{e.classList.remove(t)})}),this.lastHoveredColumnItem=null}}k([e("columnModel")],B.prototype,"columnModel",void 0),k([e("dragAndDropService")],B.prototype,"dragAndDropService",void 0),k([s],B.prototype,"postConstruct",null);var j=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class W extends i{constructor(e,t,s,i,o){super(),this.column=e,this.columnDept=t,this.allowDragging=s,this.groupsExist=i,this.focusWrapper=o,this.processingColumnStateChange=!1}init(){this.setTemplate(W.TEMPLATE),this.eDragHandle=l.createIconNoSpan("columnDrag",this.gridOptionsService),this.eDragHandle.classList.add("ag-drag-handle","ag-column-select-column-drag-handle");const e=this.cbSelect.getGui(),t=this.cbSelect.getInputElement();e.insertAdjacentElement("afterend",this.eDragHandle),t.setAttribute("tabindex","-1"),this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnToolPanel");const s=l.escapeString(this.displayName);this.eLabel.innerHTML=s;const i=this.columnDept;this.groupsExist&&this.addCssClass("ag-column-select-add-group-indent"),this.addCssClass("ag-column-select-indent-"+i),this.setupDragging(),this.addManagedListener(this.eventService,n.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,r.EVENT_VALUE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,r.EVENT_PIVOT_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,r.EVENT_ROW_GROUP_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.column,r.EVENT_VISIBLE_CHANGED,this.onColumnStateChanged.bind(this)),this.addManagedListener(this.focusWrapper,"keydown",this.handleKeyDown.bind(this)),this.addManagedListener(this.focusWrapper,"contextmenu",this.onContextMenu.bind(this)),this.addManagedPropertyListener("functionsReadOnly",this.onColumnStateChanged.bind(this)),this.addManagedListener(this.cbSelect,u.EVENT_CHANGED,this.onCheckboxChanged.bind(this)),this.addManagedListener(this.eLabel,"click",this.onLabelClicked.bind(this)),this.onColumnStateChanged(),this.refreshAriaLabel(),this.setupTooltip();p.getToolPanelClassesFromColDef(this.column.getColDef(),this.gridOptionsService,this.column,null).forEach(e=>this.addOrRemoveCssClass(e,!0))}getColumn(){return this.column}setupTooltip(){const e=()=>{const e=this.column.getColDef().headerTooltip;this.setTooltip(e)};e(),this.addManagedListener(this.eventService,n.EVENT_NEW_COLUMNS_LOADED,e)}getTooltipParams(){const e=super.getTooltipParams();return e.location="columnToolPanelColumn",e.colDef=this.column.getColDef(),e}onContextMenu(e){const{column:t,gridOptionsService:s}=this;if(s.is("functionsReadOnly"))return;const i=this.createBean(new V(t,e,this.focusWrapper));this.addDestroyFunc(()=>{i.isAlive()&&this.destroyBean(i)})}handleKeyDown(e){e.key===o.SPACE&&(e.preventDefault(),this.isSelectable()&&this.onSelectAllChanged(!this.isSelected()))}onLabelClicked(){if(this.gridOptionsService.is("functionsReadOnly"))return;const e=!this.cbSelect.getValue();this.onChangeCommon(e)}onCheckboxChanged(e){this.onChangeCommon(e.selected)}onChangeCommon(e){this.cbSelect.isReadOnly()||(this.refreshAriaLabel(),this.processingColumnStateChange||this.modelItemUtils.setColumn(this.column,e,"toolPanelUi"))}refreshAriaLabel(){const e=this.localeService.getLocaleTextFunc(),t=e("ariaColumn","Column"),s=this.cbSelect.getValue()?e("ariaVisible","visible"):e("ariaHidden","hidden"),i=e("ariaToggleVisibility","Press SPACE to toggle visibility");l.setAriaLabel(this.focusWrapper,`${this.displayName} ${t}`),this.cbSelect.setInputAriaLabel(`${i} (${s})`),l.setAriaDescribedBy(this.focusWrapper,this.cbSelect.getInputElement().id)}setupDragging(){if(!this.allowDragging)return void l.setDisplayed(this.eDragHandle,!1);const e=!this.gridOptionsService.is("suppressDragLeaveHidesColumns"),t={type:m.ToolPanel,eElement:this.eDragHandle,dragItemName:this.displayName,defaultIconName:e?g.ICON_HIDE:g.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(),onDragStarted:()=>{const e={type:n.EVENT_COLUMN_PANEL_ITEM_DRAG_START,column:this.column};this.eventService.dispatchEvent(e)},onDragStopped:()=>{const e={type:n.EVENT_COLUMN_PANEL_ITEM_DRAG_END};this.eventService.dispatchEvent(e)},onGridEnter:()=>{e&&this.onChangeCommon(!0)},onGridExit:()=>{e&&this.onChangeCommon(!1)}};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc(()=>this.dragAndDropService.removeDragSource(t))}createDragItem(){const e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}}onColumnStateChanged(){this.processingColumnStateChange=!0;const e=this.columnModel.isPivotMode();if(e){const e=this.column.isAnyFunctionActive();this.cbSelect.setValue(e)}else this.cbSelect.setValue(this.column.isVisible());let t=!0,s=!0;if(e){const e=this.gridOptionsService.is("functionsReadOnly"),i=!this.column.isAnyFunctionAllowed();t=!e&&!i,s=t}else{const{enableRowGroup:e,enableValue:i,lockPosition:o,suppressMovable:n,lockVisible:l}=this.column.getColDef(),a=!!o||!!n;t=!l,s=!!e||!!i||!a}this.cbSelect.setReadOnly(!t),this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!s),this.addOrRemoveCssClass("ag-column-select-column-readonly",!s&&!t);const i=e&&this.gridOptionsService.is("functionsPassive");this.cbSelect.setPassive(i),this.processingColumnStateChange=!1}getDisplayName(){return this.displayName}onSelectAllChanged(e){e!==this.cbSelect.getValue()&&(this.cbSelect.isReadOnly()||this.cbSelect.toggle())}isSelected(){return this.cbSelect.getValue()}isSelectable(){return!this.cbSelect.isReadOnly()}isExpandable(){return!1}setExpanded(e){console.warn("AG Grid: can not expand a column item that does not represent a column group header")}}W.TEMPLATE='<div class="ag-column-select-column" aria-hidden="true">\n            <ag-checkbox ref="cbSelect" class="ag-column-select-checkbox"></ag-checkbox>\n            <span class="ag-column-select-column-label" ref="eLabel"></span>\n        </div>',j([e("columnModel")],W.prototype,"columnModel",void 0),j([e("dragAndDropService")],W.prototype,"dragAndDropService",void 0),j([e("modelItemUtils")],W.prototype,"modelItemUtils",void 0),j([t("eLabel")],W.prototype,"eLabel",void 0),j([t("cbSelect")],W.prototype,"cbSelect",void 0),j([s],W.prototype,"init",null);var Z=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class ${constructor(e){this.items=e}getRowCount(){return this.items.length}getRow(e){return this.items[e]}}class X extends i{constructor(){super(X.TEMPLATE),this.destroyColumnItemFuncs=[]}destroyColumnTree(){this.allColsTree=[],this.destroyColumnItemFuncs.forEach(e=>e()),this.destroyColumnItemFuncs=[]}init(e,t,s){this.params=e,this.allowDragging=t,this.eventType=s,this.params.suppressSyncLayoutWithGrid||this.addManagedListener(this.eventService,n.EVENT_COLUMN_MOVED,this.onColumnsChanged.bind(this)),this.addManagedListener(this.eventService,n.EVENT_NEW_COLUMNS_LOADED,this.onColumnsChanged.bind(this));[n.EVENT_COLUMN_PIVOT_CHANGED,n.EVENT_COLUMN_PIVOT_MODE_CHANGED,n.EVENT_COLUMN_ROW_GROUP_CHANGED,n.EVENT_COLUMN_VALUE_CHANGED,n.EVENT_COLUMN_VISIBLE,n.EVENT_NEW_COLUMNS_LOADED].forEach(e=>{this.addManagedListener(this.eventService,e,this.fireSelectionChangedEvent.bind(this))}),this.expandGroupsByDefault=!this.params.contractColumnSelection;const i=this.localeService.getLocaleTextFunc()("ariaColumnList","Column List");this.virtualList=this.createManagedBean(new f("column-select","tree",i)),this.appendChild(this.virtualList.getGui()),this.virtualList.setComponentCreator((e,t)=>(l.setAriaLevel(t,e.getDept()+1),this.createComponentFromItem(e,t))),this.columnModel.isReady()&&this.onColumnsChanged(),e.suppressColumnMove||this.gridOptionsService.is("suppressMovableColumns")||this.createManagedBean(new B(this,this.virtualList))}createComponentFromItem(e,t){if(e.isGroup()){const s=new H(e,this.allowDragging,this.eventType,t);return this.getContext().createBean(s),s}const s=new W(e.getColumn(),e.getDept(),this.allowDragging,this.groupsExist,t);return this.getContext().createBean(s),s}onColumnsChanged(){const e=this.getExpandedStates(),t=this.columnModel.isPivotMode();!this.params.suppressSyncLayoutWithGrid&&!t?this.buildTreeFromWhatGridIsDisplaying():this.buildTreeFromProvidedColumnDefs(),this.setExpandedStates(e),this.markFilteredColumns(),this.flattenAndFilterModel()}getDisplayedColsList(){return this.displayedColsList}getExpandedStates(){if(!this.allColsTree)return{};const e={};return this.forEachItem(t=>{if(!t.isGroup())return;const s=t.getColumnGroup();s&&(e[s.getId()]=t.isExpanded())}),e}setExpandedStates(e){this.allColsTree&&this.forEachItem(t=>{if(!t.isGroup())return;const s=t.getColumnGroup();if(s){const i=e[s.getId()];null!=i&&t.setExpanded(i)}})}buildTreeFromWhatGridIsDisplaying(){this.colDefService.syncLayoutWithGrid(this.setColumnLayout.bind(this))}setColumnLayout(e){const t=this.colDefService.createColumnTree(e);this.buildListModel(t),this.groupsExist=e.some(e=>e&&void 0!==e.children),this.markFilteredColumns(),this.flattenAndFilterModel()}buildTreeFromProvidedColumnDefs(){this.buildListModel(this.columnModel.getPrimaryColumnTree()),this.groupsExist=this.columnModel.isPrimaryColumnGroupsPresent()}buildListModel(e){const t=this.onColumnExpanded.bind(this),s=e=>{e.addEventListener(_.EVENT_EXPANDED_CHANGED,t);const s=e.removeEventListener.bind(e,_.EVENT_EXPANDED_CHANGED,t);this.destroyColumnItemFuncs.push(s)},i=(e,t,s)=>{e.forEach(e=>{e instanceof d?o(e,t,s):n(e,t,s)})},o=(e,t,o)=>{const n=e.getColGroupDef();if(n&&n.suppressColumnsToolPanel)return;if(e.isPadding())return void i(e.getChildren(),t,o);const l=this.columnModel.getDisplayNameForProvidedColumnGroup(null,e,this.eventType),a=new _(l,e,t,!0,this.expandGroupsByDefault);o.push(a),s(a),i(e.getChildren(),t+1,a.getChildren())},n=(e,t,s)=>{if(e.getColDef()&&e.getColDef().suppressColumnsToolPanel)return;const i=this.columnModel.getDisplayNameForColumn(e,"columnToolPanel");s.push(new _(i,e,t))};this.destroyColumnTree(),i(e,0,this.allColsTree)}onColumnExpanded(){this.flattenAndFilterModel()}flattenAndFilterModel(){this.displayedColsList=[];const e=t=>{t.isPassesFilter()&&(this.displayedColsList.push(t),t.isGroup()&&t.isExpanded()&&t.getChildren().forEach(e))};this.allColsTree.forEach(e),this.virtualList.setModel(new $(this.displayedColsList));const t=this.virtualList.getLastFocusedRow();this.virtualList.refresh(),null!=t&&this.focusRowIfAlive(t),this.notifyListeners()}focusRowIfAlive(e){window.setTimeout(()=>{this.isAlive()&&this.virtualList.focusRow(e)},0)}forEachItem(e){const t=s=>{s.forEach(s=>{e(s),s.isGroup()&&t(s.getChildren())})};t(this.allColsTree)}doSetExpandedAll(e){this.forEachItem(t=>{t.isGroup()&&t.setExpanded(e)})}setGroupsExpanded(e,t){if(!t)return void this.doSetExpandedAll(e);const s=[];this.forEachItem(i=>{if(!i.isGroup())return;const o=i.getColumnGroup().getId();t.indexOf(o)>=0&&(i.setExpanded(e),s.push(o))});const i=t.filter(e=>!l.includes(s,e));i.length>0&&console.warn("AG Grid: unable to find group(s) for supplied groupIds:",i)}getExpandState(){let e=0,t=0;return this.forEachItem(s=>{s.isGroup()&&(s.isExpanded()?e++:t++)}),e>0&&t>0?x.INDETERMINATE:t>0?x.COLLAPSED:x.EXPANDED}doSetSelectedAll(e){this.modelItemUtils.selectAllChildren(this.allColsTree,e,this.eventType)}getSelectionState(){let e=0,t=0;const s=this.columnModel.isPivotMode();if(this.forEachItem(i=>{if(i.isGroup())return;if(!i.isPassesFilter())return;const o=i.getColumn(),n=o.getColDef();let l;if(s){if(!o.isAllowPivot()&&!o.isAllowRowGroup()&&!o.isAllowValue())return;l=o.isValueActive()||o.isPivotActive()||o.isRowGroupActive()}else{if(n.lockVisible)return;l=o.isVisible()}l?e++:t++}),!(e>0&&t>0))return!(0===e||t>0)}setFilterText(e){this.filterText=l.exists(e)?e.toLowerCase():null,this.markFilteredColumns(),this.flattenAndFilterModel()}markFilteredColumns(){const e=e=>{if(!l.exists(this.filterText))return!0;const t=e.getDisplayName();return null==t||-1!==t.toLowerCase().indexOf(this.filterText)},t=(s,i)=>{let o=!1;if(s.isGroup()){const n=e(s);s.getChildren().forEach(e=>{const s=t(e,n||i);s&&(o=s)})}const n=!(!i&&!o)||e(s);return s.setPassesFilter(n),n};this.allColsTree.forEach(e=>t(e,!1))}notifyListeners(){this.fireGroupExpandedEvent(),this.fireSelectionChangedEvent()}fireGroupExpandedEvent(){const e=this.getExpandState();this.dispatchEvent({type:"groupExpanded",state:e})}fireSelectionChangedEvent(){const e=this.getSelectionState();this.dispatchEvent({type:"selectionChanged",state:e})}}X.TEMPLATE='<div class="ag-column-select-list" role="presentation"></div>',Z([e("columnModel")],X.prototype,"columnModel",void 0),Z([e("toolPanelColDefService")],X.prototype,"colDefService",void 0),Z([e("modelItemUtils")],X.prototype,"modelItemUtils",void 0),Z([y],X.prototype,"destroyColumnTree",null);var z=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class K extends i{createTemplate(){return'<div class="ag-pivot-mode-panel">\n                <ag-toggle-button ref="cbPivotMode" class="ag-pivot-mode-select"></ag-toggle-button>\n            </div>'}init(){this.setTemplate(this.createTemplate()),this.cbPivotMode.setValue(this.columnModel.isPivotMode());const e=this.localeService.getLocaleTextFunc();this.cbPivotMode.setLabel(e("pivotMode","Pivot Mode")),this.addManagedListener(this.cbPivotMode,u.EVENT_CHANGED,this.onBtPivotMode.bind(this)),this.addManagedListener(this.eventService,n.EVENT_NEW_COLUMNS_LOADED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,n.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this))}onBtPivotMode(){const e=!!this.cbPivotMode.getValue();if(e!==this.columnModel.isPivotMode()){this.columnModel.setPivotMode(e,"toolPanelUi");const t=this.gridOptionsService.api;t&&t.refreshHeader()}}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.cbPivotMode.setValue(e)}}z([e("columnModel")],K.prototype,"columnModel",void 0),z([t("cbPivotMode")],K.prototype,"cbPivotMode",void 0),z([D],K.prototype,"init",null);var q=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class Q extends i{constructor(){super(Q.TEMPLATE)}init(e,t,s){this.allowDragging=e,this.params=t,this.eventType=s,this.primaryColsHeaderPanel.init(this.params);const i=this.params.suppressColumnFilter,o=this.params.suppressColumnSelectAll;this.params.suppressColumnExpandAll&&i&&o&&this.primaryColsHeaderPanel.setDisplayed(!1),this.addManagedListener(this.primaryColsListPanel,"groupExpanded",this.onGroupExpanded.bind(this)),this.addManagedListener(this.primaryColsListPanel,"selectionChanged",this.onSelectionChange.bind(this)),this.primaryColsListPanel.init(this.params,this.allowDragging,this.eventType),this.addManagedListener(this.primaryColsHeaderPanel,"expandAll",this.onExpandAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"collapseAll",this.onCollapseAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"selectAll",this.onSelectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"unselectAll",this.onUnselectAll.bind(this)),this.addManagedListener(this.primaryColsHeaderPanel,"filterChanged",this.onFilterChanged.bind(this)),this.positionableFeature=new S(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature)}toggleResizable(e){this.positionableFeature.setResizable(!!e&&{bottom:!0})}onExpandAll(){this.primaryColsListPanel.doSetExpandedAll(!0)}onCollapseAll(){this.primaryColsListPanel.doSetExpandedAll(!1)}expandGroups(e){this.primaryColsListPanel.setGroupsExpanded(!0,e)}collapseGroups(e){this.primaryColsListPanel.setGroupsExpanded(!1,e)}setColumnLayout(e){this.primaryColsListPanel.setColumnLayout(e)}onFilterChanged(e){this.primaryColsListPanel.setFilterText(e.filterText)}syncLayoutWithGrid(){this.primaryColsListPanel.onColumnsChanged()}onSelectAll(){this.primaryColsListPanel.doSetSelectedAll(!0)}onUnselectAll(){this.primaryColsListPanel.doSetSelectedAll(!1)}onGroupExpanded(e){this.primaryColsHeaderPanel.setExpandState(e.state)}onSelectionChange(e){this.primaryColsHeaderPanel.setSelectionState(e.state)}}Q.TEMPLATE='<div class="ag-column-select">\n            <ag-primary-cols-header ref="primaryColsHeaderPanel"></ag-primary-cols-header>\n            <ag-primary-cols-list ref="primaryColsListPanel"></ag-primary-cols-list>\n        </div>',q([t("primaryColsHeaderPanel")],Q.prototype,"primaryColsHeaderPanel",void 0),q([t("primaryColsListPanel")],Q.prototype,"primaryColsListPanel",void 0);var Y=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};class J extends i{constructor(){super(J.TEMPLATE),this.initialised=!1,this.childDestroyFuncs=[]}setVisible(e){super.setDisplayed(e),e&&!this.initialised&&this.init(this.params)}init(e){const t={suppressColumnMove:!1,suppressColumnSelectAll:!1,suppressColumnFilter:!1,suppressColumnExpandAll:!1,contractColumnSelection:!1,suppressPivotMode:!1,suppressRowGroups:!1,suppressValues:!1,suppressPivots:!1,suppressSyncLayoutWithGrid:!1,api:this.gridApi,columnApi:this.columnApi};if(this.params=Object.assign(Object.assign(Object.assign({},t),e),{context:this.gridOptionsService.context}),this.isRowGroupingModuleLoaded()&&!this.params.suppressPivotMode&&(this.pivotModePanel=this.createBean(new K),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotModePanel)),this.appendChild(this.pivotModePanel)),this.primaryColsPanel=this.createBean(new Q),this.childDestroyFuncs.push(()=>this.destroyBean(this.primaryColsPanel)),this.primaryColsPanel.init(!0,this.params,"toolPanelUi"),this.primaryColsPanel.addCssClass("ag-column-panel-column-select"),this.appendChild(this.primaryColsPanel),this.isRowGroupingModuleLoaded()){this.params.suppressRowGroups||(this.rowGroupDropZonePanel=this.createBean(new M(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.rowGroupDropZonePanel)),this.appendChild(this.rowGroupDropZonePanel)),this.params.suppressValues||(this.valuesDropZonePanel=this.createBean(new T(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.valuesDropZonePanel)),this.appendChild(this.valuesDropZonePanel)),this.params.suppressPivots||(this.pivotDropZonePanel=this.createBean(new N(!1)),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotDropZonePanel)),this.appendChild(this.pivotDropZonePanel)),this.setLastVisible();const e=this.addManagedListener(this.eventService,n.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>{this.resetChildrenHeight(),this.setLastVisible()});this.childDestroyFuncs.push(()=>e())}this.initialised=!0}setPivotModeSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotModePanel?this.pivotModePanel.setDisplayed(e):e&&(this.pivotModePanel=this.createBean(new K),this.getGui().insertBefore(this.pivotModePanel.getGui(),this.getGui().firstChild),this.childDestroyFuncs.push(()=>this.destroyBean(this.pivotModePanel))),this.setLastVisible())}setRowGroupsSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.rowGroupDropZonePanel?this.rowGroupDropZonePanel.setDisplayed(e):e&&(this.rowGroupDropZonePanel=this.createManagedBean(new M(!1)),this.appendChild(this.rowGroupDropZonePanel)),this.setLastVisible())}setValuesSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.valuesDropZonePanel?this.valuesDropZonePanel.setDisplayed(e):e&&(this.valuesDropZonePanel=this.createManagedBean(new T(!1)),this.appendChild(this.valuesDropZonePanel)),this.setLastVisible())}setPivotSectionVisible(e){this.isRowGroupingModuleLoaded()&&(this.pivotDropZonePanel?this.pivotDropZonePanel.setDisplayed(e):e&&(this.pivotDropZonePanel=this.createManagedBean(new N(!1)),this.appendChild(this.pivotDropZonePanel),this.pivotDropZonePanel.setDisplayed(e)),this.setLastVisible())}setResizers(){[this.primaryColsPanel,this.rowGroupDropZonePanel,this.valuesDropZonePanel,this.pivotDropZonePanel].forEach(e=>{if(!e)return;const t=e.getGui();e.toggleResizable(!t.classList.contains("ag-last-column-drop")&&!t.classList.contains("ag-hidden"))})}setLastVisible(){const e=this.getGui();Array.prototype.slice.call(e.querySelectorAll(".ag-column-drop")).forEach(e=>e.classList.remove("ag-last-column-drop"));const t=e.querySelectorAll(".ag-column-drop:not(.ag-hidden)"),s=l.last(t);s&&s.classList.add("ag-last-column-drop"),this.setResizers()}resetChildrenHeight(){const e=this.getGui().children;for(let t=0;t<e.length;t++){const s=e[t];s.style.removeProperty("height"),s.style.removeProperty("flex")}}isRowGroupingModuleLoaded(){return L.assertRegistered(P.RowGroupingModule,"Row Grouping",this.context.getGridId())}expandColumnGroups(e){this.primaryColsPanel.expandGroups(e)}collapseColumnGroups(e){this.primaryColsPanel.collapseGroups(e)}setColumnLayout(e){this.primaryColsPanel.setColumnLayout(e)}syncLayoutWithGrid(){this.primaryColsPanel.syncLayoutWithGrid()}destroyChildren(){this.childDestroyFuncs.forEach(e=>e()),this.childDestroyFuncs.length=0,l.clearElement(this.getGui())}refresh(){this.destroyChildren(),this.init(this.params)}destroy(){this.destroyChildren(),super.destroy()}}J.TEMPLATE='<div class="ag-column-panel"></div>',Y([e("gridApi")],J.prototype,"gridApi",void 0),Y([e("columnApi")],J.prototype,"columnApi",void 0);var ee=function(e,t,s,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,s,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,s,l):o(t,s))||l);return n>3&&l&&Object.defineProperty(t,s,l),l};let te=class{selectAllChildren(e,t,s){const i=this.extractAllLeafColumns(e);this.setAllColumns(i,t,s)}setColumn(e,t,s){this.setAllColumns([e],t,s)}setAllColumns(e,t,s){this.columnModel.isPivotMode()?this.setAllPivot(e,t,s):this.setAllVisible(e,t,s)}extractAllLeafColumns(e){const t=[],s=e=>{e.forEach(e=>{e.isPassesFilter()&&(e.isGroup()?s(e.getChildren()):t.push(e.getColumn()))})};return s(e),t}setAllVisible(e,t,s){const i=[];e.forEach(e=>{e.getColDef().lockVisible||e.isVisible()!=t&&i.push({colId:e.getId(),hide:!t})}),i.length>0&&this.columnModel.applyColumnState({state:i},s)}setAllPivot(e,t,s){this.gridOptionsService.is("functionsPassive")?this.setAllPivotPassive(e,t):this.setAllPivotActive(e,t,s)}setAllPivotPassive(e,t){const s=this.columnModel.getPivotColumns().slice(),i=this.columnModel.getValueColumns().slice(),o=this.columnModel.getRowGroupColumns().slice();let a=!1,r=!1,d=!1;const c=t?e=>{e.isAnyFunctionActive()||(e.isAllowValue()?(i.push(e),r=!0):e.isAllowRowGroup()?(o.push(e),a=!0):e.isAllowPivot()&&(s.push(e),d=!0))}:e=>{e.isAnyFunctionActive()&&(s.indexOf(e)>=0&&(l.removeFromArray(s,e),a=!0),i.indexOf(e)>=0&&(l.removeFromArray(i,e),r=!0),o.indexOf(e)>=0&&(l.removeFromArray(o,e),d=!0))};if(e.forEach(c),a){const e={type:n.EVENT_COLUMN_PIVOT_CHANGE_REQUEST,columns:s};this.eventService.dispatchEvent(e)}if(d){const e={type:n.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST,columns:o};this.eventService.dispatchEvent(e)}if(r){const e={type:n.EVENT_COLUMN_VALUE_CHANGE_REQUEST,columns:o};this.eventService.dispatchEvent(e)}}setAllPivotActive(e,t,s){const i=[],o=t?e=>{if(!e.isAnyFunctionActive())if(e.isAllowValue()){const t="string"==typeof e.getAggFunc()?e.getAggFunc():this.aggFuncService.getDefaultAggFunc(e);i.push({colId:e.getId(),aggFunc:t})}else e.isAllowRowGroup()?i.push({colId:e.getId(),rowGroup:!0}):e.isAllowPivot()&&i.push({colId:e.getId(),pivot:!0})}:e=>{(e.isPivotActive()||e.isRowGroupActive()||e.isValueActive())&&i.push({colId:e.getId(),pivot:!1,rowGroup:!1,aggFunc:null})};e.forEach(o),i.length>0&&this.columnModel.applyColumnState({state:i},s)}};ee([e("aggFuncService")],te.prototype,"aggFuncService",void 0),ee([e("columnModel")],te.prototype,"columnModel",void 0),ee([e("gridOptionsService")],te.prototype,"gridOptionsService",void 0),ee([e("eventService")],te.prototype,"eventService",void 0),te=ee([A("modelItemUtils")],te);const se={version:"30.0.1",moduleName:P.ColumnsToolPanelModule,beans:[te],agStackComponents:[{componentName:"AgPrimaryColsHeader",componentClass:w},{componentName:"AgPrimaryColsList",componentClass:X},{componentName:"AgPrimaryCols",componentClass:Q}],userComponents:[{componentName:"agColumnsToolPanel",componentClass:J}],dependantModules:[b,G,I]};export{se as ColumnsToolPanelModule,Q as PrimaryColsPanel};