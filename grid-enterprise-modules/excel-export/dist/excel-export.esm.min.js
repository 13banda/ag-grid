/**
          * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v30.0.0
          * @link https://www.ag-grid.com/
          * @license Commercial
          */
import{ExcelFactoryMode as e,_ as t,Autowired as r,PostConstruct as a,Bean as o,CssClassApplier as n,ModuleNames as i}from"@ag-grid-community/core";import{EnterpriseCoreModule as s}from"@ag-grid-enterprise/core";import{XmlFactory as l,BaseGridSerializingSession as p,RowType as m,ZipContainer as c,Downloader as d,BaseCreator as h,GridSerializer as g,CsvCreator as u,CsvExportModule as f}from"@ag-grid-community/csv-export";const x={getTemplate:()=>({name:"Workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",html:"http://www.w3.org/TR/REC-html40"}}],rawMap:{xmlns:"urn:schemas-microsoft-com:office:spreadsheet"}}})},y={getTemplate:()=>({name:"ExcelWorkbook",properties:{rawMap:{xmlns:"urn:schemas-microsoft-com:office:excel"}},children:[{name:"WindowHeight",textNode:"8130"},{name:"WindowWidth",textNode:"15135"},{name:"WindowHeight",textNode:"8130"},{name:"WindowTopX",textNode:"120"},{name:"WindowTopY",textNode:"45"},{name:"ProtectStructure",textNode:"False"},{name:"ProtectWindow",textNode:"False"}]})},w={getTemplate(e){const{width:t}=e;return{name:"Column",properties:{prefixedAttributes:[{prefix:"ss:",map:{Width:t}}]}}}},T={getTemplate(e){const{mergeAcross:t,styleId:r,data:a}=e,o={};return t&&(o.MergeAcross=t),r&&(o.StyleID=r),{name:"Cell",properties:{prefixedAttributes:[{prefix:"ss:",map:o}]},children:[{name:"Data",properties:{prefixedAttributes:[{prefix:"ss:",map:{Type:null==a?void 0:a.type}}]},textNode:null==a?void 0:a.value}]}}},v={getTemplate(e){const{cells:t}=e;return{name:"Row",children:t.map(e=>T.getTemplate(e))}}},S={getTemplate(e){const{table:t,name:r}=e,{columns:a,rows:o}=t,n=a.map(e=>w.getTemplate(e)),i=o.map(e=>v.getTemplate(e));return{name:"Worksheet",children:[{name:"Table",children:n.concat(i)}],properties:{prefixedAttributes:[{prefix:"ss:",map:{Name:r}}]}}}},b={getTemplate:()=>({name:"DocumentProperties",properties:{rawMap:{xmlns:"urn:schemas-microsoft-com:office:office"}},children:[{name:"Version",textNode:"12.00"}]})},M={getTemplate(e){const{vertical:t,horizontal:r,indent:a,readingOrder:o,rotate:n,shrinkToFit:i,verticalText:s,wrapText:l}=e.alignment;return{name:"Alignment",properties:{prefixedAttributes:[{prefix:"ss:",map:{Vertical:t,Horizontal:r,Indent:a,ReadingOrder:o,Rotate:n,ShrinkToFit:i,VerticalText:s,WrapText:l}}]}}}},C={getTemplate(e){const{borderBottom:t,borderLeft:r,borderRight:a,borderTop:o}=e.borders;return{name:"Borders",children:[t,r,a,o].map((e,t)=>({name:"Border",properties:{prefixedAttributes:[{prefix:"ss:",map:{Position:0==t?"Bottom":1==t?"Left":2==t?"Right":"Top",LineStyle:e.lineStyle,Weight:e.weight,Color:e.color}}]}}))}}},I={getTemplate(e){const{bold:t,fontName:r,italic:a,color:o,outline:n,shadow:i,size:s,strikeThrough:l,underline:p,verticalAlign:m,charSet:c,family:d}=e.font;return{name:"Font",properties:{prefixedAttributes:[{prefix:"ss:",map:{Bold:t,FontName:r,Italic:a,Color:o,Outline:n,Shadow:i,Size:s,StrikeThrough:l,Underline:p,VerticalAlign:m}},{prefix:"x:",map:{CharSet:c,Family:d}}]}}}},E={getTemplate(e){const{color:t,pattern:r,patternColor:a}=e.interior;return{name:"Interior",properties:{prefixedAttributes:[{prefix:"ss:",map:{Color:t,Pattern:r,PatternColor:a}}]}}}},k={getTemplate:e=>({name:"Protection",properties:{prefixedAttributes:[{prefix:"ss:",map:{Protected:e.protection.protected,HideFormula:e.protection.hideFormula}}]}})},D={getTemplate(e){const{format:t}=e.numberFormat;return{name:"NumberFormat",properties:{prefixedAttributes:[{prefix:"ss:",map:{Format:t}}]}}}},F={getTemplate(e){const{id:t,name:r}=e;return{name:"Style",properties:{prefixedAttributes:[{prefix:"ss:",map:{ID:t,Name:r||t}}]}}}};class N{static createExcel(e,t){const r=this.excelXmlHeader(),a=b.getTemplate(),o=y.getTemplate(),n=this.workbook(a,o,e,t);return`${r}${l.createXml(n,e=>e?"1":"0")}`}static workbook(e,t,r,a){const o=[e,t,this.stylesXmlElement(r)].concat(S.getTemplate(a));return Object.assign({},x.getTemplate(),{children:o})}static excelXmlHeader(){return'<?xml version="1.0" ?>\n        <?mso-application progid="Excel.Sheet" ?>\n        '}static stylesXmlElement(e){return{name:"Styles",children:e?e.map(e=>this.styleXmlElement(e)):[]}}static styleXmlElement(e){const r=t.compose(this.addProperty("alignment",e),this.addProperty("borders",e),this.addProperty("font",e),this.addProperty("interior",e),this.addProperty("protection",e),this.addProperty("numberFormat",e))([]);return Object.assign({},F.getTemplate(e),{children:r})}static addProperty(e,t){return r=>{if(!t[e])return r;const a={alignment:M,borders:C,font:I,interior:E,numberFormat:D,protection:k};return r.concat(a[e].getTemplate(t))}}}N.factoryMode=e.SINGLE_SHEET;const A={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},P=e=>Math.ceil(9525*e),O=(e,t)=>{if(!t)return;let r;if("number"==typeof t)r=t;else{r=t({rowIndex:e})}return a=r,Math.round(72*a/96);var a},L=e=>`${l.createHeader({encoding:"UTF-8",standalone:"yes"})}${l.createXml(e)}`,R=e=>{const t=String.fromCharCode,r=Math.floor(e/26),a=e%26;return r&&26!==e?a?r<26?t(65+r-1)+t(65+a-1):R(r)+t(65+a-1):R(r-1)+"Z":t(65+e-1)};class B extends p{constructor(e){super(e),this.mixedStyles={},this.mixedStyleCounter=0,this.rows=[],this.config=Object.assign({},e),this.stylesByIds={},this.config.baseExcelStyles.forEach(e=>{this.stylesByIds[e.id]=e}),this.excelStyles=[...this.config.baseExcelStyles]}addCustomContent(e){e.forEach(e=>{const t=this.rows.length+1;let r;this.config.suppressRowOutline||null==e.outlineLevel||(r=e.outlineLevel);const a={height:O(t,e.height||this.config.rowHeight),cells:(e.cells||[]).map((e,r)=>{var a,o,n;const i=this.addImage(t,this.columnsToExport[r],null===(a=e.data)||void 0===a?void 0:a.value);let s=null;e.styleId&&(s="string"==typeof e.styleId?[e.styleId]:e.styleId);const l=this.getStyleId(s);if(i)return this.createCell(l,this.getDataTypeForValue(i.value),null==i.value?"":i.value);const p=null!==(n=null===(o=e.data)||void 0===o?void 0:o.value)&&void 0!==n?n:"",m=this.getDataTypeForValue(p);return e.mergeAcross?this.createMergedCell(l,m,p,e.mergeAcross):this.createCell(l,m,p)}),outlineLevel:r};null!=e.collapsed&&(a.collapsed=e.collapsed),null!=e.hidden&&(a.hidden=e.hidden),this.rows.push(a)})}onNewHeaderGroupingRow(){const e=[];return this.rows.push({cells:e,height:O(this.rows.length+1,this.config.headerRowHeight)}),{onColumn:(t,r,a,o,n)=>{const i=this.config.styleLinker({rowType:m.HEADER_GROUPING,rowIndex:1,value:"grouping-"+r,columnGroup:t});e.push(Object.assign(Object.assign({},this.createMergedCell(this.getStyleId(i),this.getDataTypeForValue("string"),r,o)),{collapsibleRanges:n}))}}}onNewHeaderRow(){return this.onNewRow(this.onNewHeaderColumn,this.config.headerRowHeight)}onNewBodyRow(e){const t=this.onNewRow(this.onNewBodyColumn,this.config.rowHeight);return e&&this.addRowOutlineIfNecessary(e),t}addRowOutlineIfNecessary(e){const{gridOptionsService:r,suppressRowOutline:a,rowGroupExpandState:o="expanded"}=this.config;if(r.is("groupHideOpenParents")||a||null==e.level)return;const n=e.footer?1:0,i=t.last(this.rows);if(i.outlineLevel=e.level+n,"expanded"===o)return;const s="collapsed"===o;if(e.isExpandable()){const t=!s&&e.expanded;i.collapsed=!t}i.hidden=!!e.parent&&-1!==e.parent.level&&(s||this.isAnyParentCollapsed(e.parent))}isAnyParentCollapsed(e){for(;e&&-1!==e.level;){if(!e.expanded)return!0;e=e.parent}return!1}prepare(e){super.prepare(e),this.columnsToExport=[...e],this.cols=e.map((e,t)=>this.convertColumnToExcel(e,t))}parse(){const e=this.rows.reduce((e,t)=>Math.max(e,t.cells.length),0);for(;this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));const t={name:this.config.sheetName,table:{columns:this.cols,rows:this.rows}};return this.createExcel(t)}isFormula(e){return null!=e&&(this.config.autoConvertFormulas&&e.toString().startsWith("="))}isNumerical(e){return"bigint"==typeof e||isFinite(e)&&""!==e&&!isNaN(parseFloat(e))}getStyleById(e){return null==e?null:this.stylesByIds[e]||null}convertColumnToExcel(e,t){const r=this.config.columnWidth;if(r)return"number"==typeof r?{width:r}:{width:r({column:e,index:t})};if(e){const t=75;return{width:Math.max(e.getActualWidth(),t)}}return{}}onNewHeaderColumn(e,t){return(r,a)=>{const o=this.extractHeaderValue(r),n=this.config.styleLinker({rowType:m.HEADER,rowIndex:e,value:o,column:r});t.push(this.createCell(this.getStyleId(n),this.getDataTypeForValue("string"),o))}}onNewRow(e,t){const r=[];return this.rows.push({cells:r,height:O(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,r)()}}onNewBodyColumn(e,t){let r=0;return(a,o,n)=>{if(r>0)return void(r-=1);const{value:i,valueFormatted:s}=this.extractRowCellValue(a,o,e,"excel",n),l=this.config.styleLinker({rowType:m.BODY,rowIndex:e,value:i,column:a,node:n}),p=this.getStyleId(l),c=a.getColSpan(n),d=this.addImage(e,a,i);d?t.push(this.createCell(p,this.getDataTypeForValue(d.value),null==d.value?"":d.value)):c>1?(r=c-1,t.push(this.createMergedCell(p,this.getDataTypeForValue(i),i,c-1))):t.push(this.createCell(p,this.getDataTypeForValue(i),i,s))}}getStyleId(e){if(!e||!e.length)return null;if(1===e.length)return e[0];const t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID}addNewMixedStyle(e){this.mixedStyleCounter+=1;const r="mixedStyle"+this.mixedStyleCounter,a={};e.forEach(e=>{this.excelStyles.forEach(r=>{r.id===e&&t.mergeDeep(a,t.deepCloneObject(r))})}),a.id=r,a.name=r;const o=e.join("-");this.mixedStyles[o]={excelID:r,key:o,result:a},this.excelStyles.push(a),this.stylesByIds[r]=a}}class H extends B{createExcel(e){return N.createExcel(this.excelStyles,e)}getDataTypeForValue(e){return this.isNumerical(e)?"Number":"String"}getType(e,t,r){if(this.isFormula(r))return"Formula";if(t&&t.dataType)switch(t.dataType.toLocaleLowerCase()){case"string":return"Formula";case"number":return"Number";case"datetime":return"DateTime";case"error":return"Error";case"boolean":return"Boolean";default:console.warn(`AG Grid: Unrecognized data type for excel export [${t.id}.dataType=${t.dataType}]`)}return e}addImage(){}createCell(e,t,r,a){const o=this.getStyleById(e);!(null==o?void 0:o.dataType)&&"String"===t&&a&&(r=a);const n=this.getType(t,o,r)||t;return{styleId:o?e:void 0,data:{type:n,value:this.getValueTransformed(n,r)}}}getValueTransformed(e,r){const a=e=>{if(this.config.suppressTextAsCDATA)return t.escapeString(e);const r=new RegExp("]]>","g");return"<![CDATA["+String(e).replace(r,"]]]]><![CDATA[>")+"]]>"};switch(e){case"String":return a(r);case"Number":return Number(r).valueOf()+"";case"Boolean":return(o=r)&&"0"!==o&&"false"!==o?"1":"0";default:return r}var o}createMergedCell(e,t,r,a){return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:r},mergeAcross:a}}}const z={getTemplate(e){const t=(new Date).toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t}]}}},$={getTemplate(e){const{name:t,ContentType:r,Extension:a,PartName:o}=e;return{name:t,properties:{rawMap:{Extension:a,PartName:o,ContentType:r}}}}},G={getTemplate(e){const t=new Array(e).fill(void 0).map((e,t)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:`/xl/worksheets/sheet${t+1}.xml`})),r=ht.worksheetImages.size,a={};ht.workbookImageIds.forEach(e=>{a[e.type]=!0});const o=new Array(r).fill(void 0).map((e,t)=>({name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:`/xl/drawings/drawing${t+1}.xml`}));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:[...Object.keys(a).map(e=>({name:"Default",ContentType:"image/"+e,Extension:e})),{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"},...t,{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"},...o,{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}].map(e=>$.getTemplate(e))}}},W=(e,t)=>({name:"xdr:"+e,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}),j=e=>{const t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},V=(e,t)=>({name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:null!=e.altText?e.altText:void 0}},children:[j(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}),U=e=>{if(!e.saturation&&!e.tint)return;const t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:1e3*e.saturation}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:1e3*e.tint}}}),t},_=(e,t)=>{let r;if(e.transparency){const t=Math.min(Math.max(e.transparency,0),100);r=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(1e3*t)}}}]}if(e.recolor)switch(r||(r=[]),e.recolor.toLocaleLowerCase()){case"grayscale":r.push({name:"a:grayscl"});break;case"sepia":r.push((o={color:"D9C3A5",tint:50,saturation:180},{name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:(a={color:"black"}).color}},children:U(a)},{name:"a:srgbClr",properties:{rawMap:{val:o.color}},children:U(o)}]}));break;case"washout":r.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}})}var a,o;return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":"rId"+t,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:r},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},X=(e,t)=>{const r={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){const t=e.rotation;r.properties={rawMap:{rot:6e4*Math.min(Math.max(t,0),360)}}}return{name:"xdr:spPr",children:[r,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},J=(e,t,r,a)=>({name:"xdr:pic",children:[V(e,t+1),_(e,r+1),X(e,a)]}),Y={getTemplate(e){const{sheetIndex:t}=e,r=ht.worksheetImages.get(t),a=ht.worksheetImageIds.get(t);return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:r.map((e,t)=>{const r=(e=>{e.fitCell=!!e.fitCell||!e.width||!e.height;const{position:t={},fitCell:r,width:a=0,height:o=0,totalHeight:n,totalWidth:i}=e,{offsetX:s=0,offsetY:l=0,row:p=1,rowSpan:m=1,column:c=1,colSpan:d=1}=t;return{from:{row:p-1,col:c-1,offsetX:P(s),offsetY:P(l)},to:{row:p-1+(r?1:m-1),col:c-1+(r?1:d-1),offsetX:P(a+s),offsetY:P(o+l)},height:P(n||o),width:P(i||a)}})(e);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[W("from",r.from),W("to",r.to),J(e,t,a.get(e.id).index,r),{name:"xdr:clientData"}]}})}}},K=e=>{const[t,r,a,o]=e;return{name:"a:"+t,children:[{name:"a:"+r,properties:{rawMap:{val:a,lastClr:o}}}]}},q={getTemplate:()=>({name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[K(["dk1","sysClr","windowText","000000"]),K(["lt1","sysClr","window","FFFFFF"]),K(["dk2","srgbClr","44546A"]),K(["lt2","srgbClr","E7E6E6"]),K(["accent1","srgbClr","4472C4"]),K(["accent2","srgbClr","ED7D31"]),K(["accent3","srgbClr","A5A5A5"]),K(["accent4","srgbClr","FFC000"]),K(["accent5","srgbClr","5B9BD5"]),K(["accent6","srgbClr","70AD47"]),K(["hlink","srgbClr","0563C1"]),K(["folHlink","srgbClr","954F72"])]})},Z=e=>{const[t,r,a,o]=e;return{name:"a:"+t,properties:{rawMap:{script:a,typeface:r,panose:o}}}},Q={getTemplate(){const{utf8_encode:e}=t;return{name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[Z(["latin","Calibri Light",void 0,"020F0302020204030204"]),Z(["ea",""]),Z(["cs",""]),Z(["font",e("\u6e38\u30b4\u30b7\u30c3\u30af Light"),"Jpan"]),Z(["font",e("\ub9d1\uc740 \uace0\ub515"),"Hang"]),Z(["font",e("\u7b49\u7ebf Light"),"Hans"]),Z(["font",e("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),Z(["font","Times New Roman","Arab"]),Z(["font","Times New Roman","Hebr"]),Z(["font","Tahoma","Thai"]),Z(["font","Nyala","Ethi"]),Z(["font","Vrinda","Beng"]),Z(["font","Shruti","Gujr"]),Z(["font","MoolBoran","Khmr"]),Z(["font","Tunga","Knda"]),Z(["font","Raavi","Guru"]),Z(["font","Euphemia","Cans"]),Z(["font","Plantagenet Cherokee","Cher"]),Z(["font","Microsoft Yi Baiti","Yiii"]),Z(["font","Microsoft Himalaya","Tibt"]),Z(["font","MV Boli","Thaa"]),Z(["font","Mangal","Deva"]),Z(["font","Gautami","Telu"]),Z(["font","Latha","Taml"]),Z(["font","Estrangelo Edessa","Syrc"]),Z(["font","Kalinga","Orya"]),Z(["font","Kartika","Mlym"]),Z(["font","DokChampa","Laoo"]),Z(["font","Iskoola Pota","Sinh"]),Z(["font","Mongolian Baiti","Mong"]),Z(["font","Times New Roman","Viet"]),Z(["font","Microsoft Uighur","Uigh"]),Z(["font","Sylfaen","Geor"]),Z(["font","Arial","Armn"]),Z(["font","Leelawadee UI","Bugi"]),Z(["font","Microsoft JhengHei","Bopo"]),Z(["font","Javanese Text","Java"]),Z(["font","Segoe UI","Lisu"]),Z(["font","Myanmar Text","Mymr"]),Z(["font","Ebrima","Nkoo"]),Z(["font","Nirmala UI","Olck"]),Z(["font","Ebrima","Osma"]),Z(["font","Phagspa","Phag"]),Z(["font","Estrangelo Edessa","Syrn"]),Z(["font","Estrangelo Edessa","Syrj"]),Z(["font","Estrangelo Edessa","Syre"]),Z(["font","Nirmala UI","Sora"]),Z(["font","Microsoft Tai Le","Tale"]),Z(["font","Microsoft New Tai Lue","Talu"]),Z(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[Z(["latin","Calibri",void 0,"020F0502020204030204"]),Z(["ea",""]),Z(["cs",""]),Z(["font",e("\u6e38\u30b4\u30b7\u30c3\u30af"),"Jpan"]),Z(["font",e("\ub9d1\uc740 \uace0\ub515"),"Hang"]),Z(["font",e("\u7b49\u7ebf"),"Hans"]),Z(["font",e("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),Z(["font","Arial","Arab"]),Z(["font","Arial","Hebr"]),Z(["font","Tahoma","Thai"]),Z(["font","Nyala","Ethi"]),Z(["font","Vrinda","Beng"]),Z(["font","Shruti","Gujr"]),Z(["font","DaunPenh","Khmr"]),Z(["font","Tunga","Knda"]),Z(["font","Raavi","Guru"]),Z(["font","Euphemia","Cans"]),Z(["font","Plantagenet Cherokee","Cher"]),Z(["font","Microsoft Yi Baiti","Yiii"]),Z(["font","Microsoft Himalaya","Tibt"]),Z(["font","MV Boli","Thaa"]),Z(["font","Mangal","Deva"]),Z(["font","Gautami","Telu"]),Z(["font","Latha","Taml"]),Z(["font","Estrangelo Edessa","Syrc"]),Z(["font","Kalinga","Orya"]),Z(["font","Kartika","Mlym"]),Z(["font","DokChampa","Laoo"]),Z(["font","Iskoola Pota","Sinh"]),Z(["font","Mongolian Baiti","Mong"]),Z(["font","Arial","Viet"]),Z(["font","Microsoft Uighur","Uigh"]),Z(["font","Sylfaen","Geor"]),Z(["font","Arial","Armn"]),Z(["font","Leelawadee UI","Bugi"]),Z(["font","Microsoft JhengHei","Bopo"]),Z(["font","Javanese Text","Java"]),Z(["font","Segoe UI","Lisu"]),Z(["font","Myanmar Text","Mymr"]),Z(["font","Ebrima","Nkoo"]),Z(["font","Nirmala UI","Olck"]),Z(["font","Ebrima","Osma"]),Z(["font","Phagspa","Phag"]),Z(["font","Estrangelo Edessa","Syrn"]),Z(["font","Estrangelo Edessa","Syrj"]),Z(["font","Estrangelo Edessa","Syre"]),Z(["font","Nirmala UI","Sora"]),Z(["font","Microsoft Tai Le","Tale"]),Z(["font","Microsoft New Tai Lue","Talu"]),Z(["font","Ebrima","Tfng"])]}]}}},ee=(e,t,r)=>({name:"a:"+e,properties:{rawMap:{val:t}},children:r}),te=e=>{const[t,r,a,o,n,i]=e,s=[];return s.push(ee("satMod",a)),o&&s.push(ee("lumMod",o)),n&&s.push(ee("tint",n)),i&&s.push(ee("shade",i)),{name:"a:gs",properties:{rawMap:{pos:t}},children:[{name:"a:schemeClr",properties:{rawMap:{val:r}},children:s}]}},re=(e,t)=>({name:"a:solidFill",children:[ee("schemeClr",e,t)]}),ae=e=>{const[t,r,a,o,n]=e,[i,s]=n;return{name:"a:gradFill",properties:{rawMap:{rotWithShape:t}},children:[{name:"a:gsLst",children:[te(r),te(a),te(o)]},{name:"a:lin",properties:{rawMap:{ang:i,scaled:s}}}]}},oe=e=>{const[t,r,a,o]=e;return{name:"a:ln",properties:{rawMap:{w:t,cap:r,cmpd:a,algn:o}},children:[re("phClr"),ee("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},ne=e=>{const t=[];if(e){const[r,a,o,n,i]=e;t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:r,dist:a,dir:o,algn:n,rotWithShape:i}},children:[ee("srgbClr","000000",[ee("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},ie={getTemplate:()=>({name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:fillStyleLst",children:[re("phClr"),ae(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),ae(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]},{name:"a:lnStyleLst",children:[oe(["6350","flat","sng","ctr"]),oe(["12700","flat","sng","ctr"]),oe(["19050","flat","sng","ctr"])]},{name:"a:effectStyleLst",children:[ne(),ne(),ne(["57150","19050","5400000","ctr","0"])]},{name:"a:bgFillStyleLst",children:[re("phClr"),re("phClr",[ee("tint","95000"),ee("satMod","170000")]),ae(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}]})},se={getTemplate:()=>({name:"a:themeElements",children:[q.getTemplate(),Q.getTemplate(),ie.getTemplate()]})},le={getTemplate:()=>({name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[se.getTemplate(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]})},pe=e=>{const r=[];return e.forEach((e,a)=>{const o=a.toString(),n={name:"t",textNode:t.utf8_encode(t.escapeString(o))};o.trim().length!==o.length&&(n.properties={rawMap:{"xml:space":"preserve"}}),r.push({name:"si",children:[n]})}),r},me={getTemplate:e=>({name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:pe(e)})},ce={getTemplate(e){let{formatCode:r,numFmtId:a}=e;return r.length&&(r=t.escapeString(r.replace(/\$/g,'"$"'))),{name:"numFmt",properties:{rawMap:{formatCode:r,numFmtId:a}}}}},de={getTemplate:e=>({name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map(e=>ce.getTemplate(e))})},he={getTemplate(e){const{size:t,colorTheme:r,color:a="FF000000",fontName:o="Calibri",family:n,scheme:i,italic:s,bold:l,strikeThrough:p,outline:m,shadow:c,underline:d,verticalAlign:h}=e,g=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:r,rgb:a}}},{name:"name",properties:{rawMap:{val:o}}}];return n&&g.push({name:"family",properties:{rawMap:{val:n}}}),i&&g.push({name:"scheme",properties:{rawMap:{val:i}}}),s&&g.push({name:"i"}),l&&g.push({name:"b"}),p&&g.push({name:"strike"}),m&&g.push({name:"outline"}),c&&g.push({name:"shadow"}),d&&g.push({name:"u",properties:{rawMap:{val:d}}}),h&&g.push({name:"vertAlign",properties:{rawMap:{val:h}}}),{name:"font",children:g}}},ge={getTemplate:e=>({name:"fonts",properties:{rawMap:{count:e.length}},children:e.map(e=>he.getTemplate(e))})},ue={getTemplate(e){const{patternType:t,fgTheme:r,fgTint:a,fgRgb:o,bgRgb:n,bgIndexed:i}=e,s={name:"patternFill",properties:{rawMap:{patternType:t}}};return(r||a||o)&&(s.children=[{name:"fgColor",properties:{rawMap:{theme:r,tint:a,rgb:o}}}]),(i||n)&&(s.children||(s.children=[]),s.children.push({name:"bgColor",properties:{rawMap:{indexed:i,rgb:n}}})),{name:"fill",children:[s]}}},fe={getTemplate:e=>({name:"fills",properties:{rawMap:{count:e.length}},children:e.map(e=>ue.getTemplate(e))})},xe={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot"},ye=["Dashed","DashDot","DashDotDot"],we={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},Te={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},ve={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},Se=e=>null==e?e:("#"===e.charAt(0)&&(e=e.substr(1)),6===e.length?"FF"+e:e),be=(e,t)=>{if(!e)return"thin";const r=(e=>{switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}})(t),a=xe[e];return"Continuous"===e?r:"medium"===r&&-1!==ye.indexOf(a)?"medium"+a:a.charAt(0).toLowerCase()+a.substr(1)},Me=e=>Te[e]||"general",Ce=e=>ve[e]||void 0,Ie=e=>({name:"color",properties:{rawMap:{rgb:Se(e||"#000000")}}}),Ee={getTemplate(e){const{left:t,right:r,top:a,bottom:o,diagonal:n}=e,i=t?[Ie(t.color)]:void 0,s=r?[Ie(r.color)]:void 0,l=a?[Ie(a.color)]:void 0,p=o?[Ie(o.color)]:void 0,m=n?[Ie(n.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:i},{name:"right",properties:{rawMap:{style:r&&r.style}},children:s},{name:"top",properties:{rawMap:{style:a&&a.style}},children:l},{name:"bottom",properties:{rawMap:{style:o&&o.style}},children:p},{name:"diagonal",properties:{rawMap:{style:n&&n.style}},children:m}]}}},ke={getTemplate:e=>({name:"borders",properties:{rawMap:{count:e.length}},children:e.map(e=>Ee.getTemplate(e))})},De=e=>{const t=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(t,0)},Fe={getTemplate(e){const{horizontal:t,indent:r,readingOrder:a,rotate:o,shrinkToFit:n,vertical:i,wrapText:s}=e;return{name:"alignment",properties:{rawMap:{horizontal:t&&Me(t),indent:r,readingOrder:a&&De(a),textRotation:o,shrinkToFit:n,vertical:i&&Ce(i),wrapText:s}}}}},Ne={getTemplate(e){const t=!1===e.protected?0:1;return{name:"protection",properties:{rawMap:{hidden:!0===e.hideFormula?1:0,locked:t}}}}},Ae={getTemplate(e){const{alignment:t,borderId:r,fillId:a,fontId:o,numFmtId:n,protection:i,xfId:s}=e,l=[];return t&&l.push(Fe.getTemplate(t)),i&&l.push(Ne.getTemplate(i)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:i?1:void 0,applyBorder:r?1:void 0,applyFill:a?1:void 0,borderId:r,fillId:a,applyFont:o?1:void 0,fontId:o,applyNumberFormat:n?1:void 0,numFmtId:n,xfId:s}},children:l.length?l:void 0}}},Pe={getTemplate:e=>({name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map(e=>Ae.getTemplate(e))})},Oe={getTemplate:e=>({name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map(e=>Ae.getTemplate(e))})},Le={getTemplate(e){const{builtinId:t,name:r,xfId:a}=e;return{name:"cellStyle",properties:{rawMap:{builtinId:t,name:r,xfId:a}}}}},Re={getTemplate:e=>({name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map(e=>Le.getTemplate(e))})};let Be,He,ze,$e,Ge,We,je,Ve,Ue;const _e=(e,t)=>(-1!==e.indexOf("mixedStyle")&&t>1&&(e+="_"+t),e),Xe=()=>{Be={base:0},He=[],ze=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],$e=[{patternType:"none"},{patternType:"gray125"}],Ge=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],We=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],je=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],Ve=[{builtinId:0,name:"Normal",xfId:0}]},Je=e=>{const t=(r=e.pattern)?we[r]||r:"none";var r;const a=Se(e.color),o=Se(e.patternColor);let n=$e.findIndex(e=>{const{patternType:r,fgRgb:n,bgRgb:i}=e;return r==t&&n==a&&i==o});return-1===n&&(n=$e.length,$e.push({patternType:t,fgRgb:a,bgRgb:o})),n},Ye=e=>{const{fontName:r="Calibri",color:a,size:o,bold:n,italic:i,outline:s,shadow:l,strikeThrough:p,underline:m,family:c,verticalAlign:d}=e,h=r?t.utf8_encode(r):r,g=Se(a),u=(e=>{if(void 0===e)return;const t=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(t,0)})(c),f=m?m.toLocaleLowerCase():void 0,x=d?d.toLocaleLowerCase():void 0;let y=ze.findIndex(e=>e.fontName==h&&e.color==g&&e.size==o&&e.bold==n&&e.italic==i&&e.outline==s&&e.shadow==l&&e.strikeThrough==p&&e.underline==f&&e.verticalAlign==x&&e.family==u);return-1===y&&(y=ze.length,ze.push({fontName:h,color:g,size:o,bold:n,italic:i,outline:s,shadow:l,strikeThrough:p,underline:f,verticalAlign:x,family:null!=u?u.toString():void 0})),y},Ke=e=>{const{alignment:r,borders:a,font:o,interior:n,numberFormat:i,protection:s}=e;let{id:l}=e,p=0,m=0,c=0,d=0;l&&(l=_e(l,Ue),null==Be[l]&&(n&&(p=Je(n)),a&&(m=(e=>{const{borderBottom:t,borderTop:r,borderLeft:a,borderRight:o}=e;let n,i,s,l,p,m,c,d;a&&(s=be(a.lineStyle,a.weight),c=Se(a.color)),o&&(l=be(o.lineStyle,o.weight),d=Se(o.color)),t&&(n=be(t.lineStyle,t.weight),p=Se(t.color)),r&&(i=be(r.lineStyle,r.weight),m=Se(r.color));let h=Ge.findIndex(e=>{const{left:t,right:r,top:a,bottom:o}=e;if(!t&&(s||c))return!1;if(!r&&(l||d))return!1;if(!a&&(i||m))return!1;if(!o&&(n||p))return!1;const{style:h,color:g}=t||{},{style:u,color:f}=r||{},{style:x,color:y}=a||{},{style:w,color:T}=o||{};return h==s&&g==c&&(u==l&&f==d&&(x==i&&y==m&&(w==n&&T==p)))});return-1===h&&(h=Ge.length,Ge.push({left:{style:s,color:c},right:{style:l,color:d},top:{style:i,color:m},bottom:{style:n,color:p},diagonal:{style:void 0,color:void 0}})),h})(a)),o&&(c=Ye(o)),i&&(d=(e=>{if(e=t.utf8_encode(e),A[e])return A[e];let r=He.findIndex(t=>t.formatCode===e);return-1===r?(r=He.length+164,He.push({formatCode:e,numFmtId:r})):r=He[r].numFmtId,r})(i.format)),Be[l]=je.length,je.push({alignment:r,borderId:m||0,fillId:p||0,fontId:c||0,numFmtId:d||0,protection:s,xfId:0})))},qe={getTemplate(e){const t=de.getTemplate(He),r=ge.getTemplate(ze.map(t=>Object.assign(Object.assign({},t),{size:null!=t.size?t.size:e}))),a=fe.getTemplate($e),o=ke.getTemplate(Ge),n=Pe.getTemplate(We),i=Oe.getTemplate(je),s=Re.getTemplate(Ve);return Xe(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,r,a,o,n,i,s,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}}},Ze=(e,t)=>Be[_e(e,t)]||0,Qe={getTemplate(e,t){const r=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:r,"r:id":"rId"+r}}}}},et={getTemplate:e=>({name:"sheets",children:e.map((e,t)=>Qe.getTemplate(e,t))})},tt={getTemplate:e=>({name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[et.getTemplate(e)]})},rt={getTemplate(e){const{min:t,max:r,outlineLevel:a,s:o,width:n,hidden:i,bestFit:s}=e;let l=1,p="0";return n>1&&(l=(e=>Math.ceil((e-12)/7+1))(n),p="1"),{name:"col",properties:{rawMap:{min:t,max:r,outlineLevel:null!=a?a:void 0,width:l,style:o,hidden:i?"1":"0",bestFit:s?"1":"0",customWidth:p}}}}},at={getTemplate(e,r,a){const{ref:o,data:n,styleId:i}=e,{type:s,value:l}=n||{type:"empty",value:null};let p=s;"f"===s?p="str":s.charAt(0)===s.charAt(0).toUpperCase()&&(p=(e=>{const t=e.charAt(0).toLowerCase();return"s"===t?"inlineStr":t})(s));const m={name:"c",properties:{rawMap:{r:o,t:"empty"===p?void 0:p,s:i?Ze(i,a):void 0}}};if("empty"===p)return m;let c;return c="str"===p&&"f"===s?[{name:"f",textNode:t.escapeString(t.utf8_encode(l))}]:"inlineStr"===p?[{name:"is",children:[{name:"t",textNode:t.escapeString(t.utf8_encode(l))}]}]:[{name:"v",textNode:l}],Object.assign({},m,{children:c})}},ot=e=>{var t;return""!==(null===(t=e.data)||void 0===t?void 0:t.value)||void 0!==e.styleId},nt={getTemplate(e,t,r){const{collapsed:a,hidden:o,height:n,outlineLevel:i,cells:s=[]}=e;((e,t)=>{const r=[];let a=0;for(let t=0;t<e.length;t++){const o=e[t];o.mergeAcross&&(r.push({pos:t,excelPos:a}),a+=o.mergeAcross),a++}if(r.length)for(let a=r.length-1;a>=0;a--){const o=[],n=e[r[a].pos];for(let e=1;e<=n.mergeAcross;e++)o.push({ref:`${R(r[a].excelPos+1+e)}${t+1}`,styleId:n.styleId,data:{type:"empty",value:null}});o.length&&e.splice(r[a].pos+1,0,...o)}})(s,t);return{name:"row",properties:{rawMap:{r:t+1,collapsed:a?"1":"0",hidden:o?"1":"0",ht:n,customHeight:null!=n?"1":"0",spans:"1:1",outlineLevel:i||void 0}},children:s.filter(ot).map((e,t)=>at.getTemplate(e,t,r))}}},it={getTemplate:e=>({name:"mergeCell",properties:{rawMap:{ref:e}}})},st=e=>{if(null==e)return 1;const t=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return-1===t?1:t+1},lt=e=>e.reduce((e,r)=>{var a;return`${((e,t)=>t?(e+="&amp;&quot;",e+=t.fontName||"Calibri",t.bold!==t.italic?e+=t.bold?",Bold":",Italic":t.bold?e+=",Bold Italic":e+=",Regular",e+="&quot;",t.size&&(e+="&amp;"+t.size),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+="&amp;"+("Double"===t.underline?"E":"U")),t.color&&(e+="&amp;K"+t.color.replace("#","").toUpperCase()),e):e)(`${e}&amp;${"Center"===(a=r.position)?"C":"Right"===a?"R":"L"}`,r.font)}${t.escapeString((o=r.value,t.iterateObject({"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F"},(e,t)=>{o=o.replace(e,t)}),o))}`;var o},""),pt=e=>{const r=[];return["all","first","even"].forEach(a=>{const o=e[a],n="all"===a?"odd":a;o&&(o.header||o.footer)&&t.iterateObject(o,(e,t)=>{const a=`${e.charAt(0).toUpperCase()}${e.slice(1)}`;t&&r.push({name:`${n}${a}`,properties:{rawMap:{"xml:space":"preserve"}},textNode:lt(t)})})}),r},mt={getTemplate(e){const{worksheet:r,currentSheet:a,config:o}=e,{margins:n={},pageSetup:i,headerFooterConfig:s,suppressColumnOutline:l}=o,{table:p}=r,{rows:m,columns:c}=p,d=c&&c.length?((e,t,r)=>{const a=[],o=[];e.forEach((e,r)=>{const n=e.cells;let i,s=0;n.forEach((e,n)=>{const l=n+s+1,p=R(l),m=r+1;if(e.mergeAcross){s+=e.mergeAcross;const t=R(n+s+1);a.push(`${p}${m}:${t}${m}`)}t[l-1]||(t[l-1]={});const{collapsibleRanges:c}=e;c&&c.forEach(e=>{o.push([l+e[0],l+e[1]])}),i=t[l-1],i.min=l,i.max=l,e.ref=`${p}${m}`})}),o.sort((e,t)=>e[0]!==t[0]?e[0]-t[0]:t[1]-e[1]);const n=new Map,i=new Map;return o.filter(e=>{const t=e.toString();return!n.get(t)&&(n.set(t,!0),!0)}).forEach(e=>{const a=t.find(t=>t.min==e[0]&&t.max==e[1]),o=i.get(e[0]);t.push({min:e[0],max:e[1],outlineLevel:r?void 0:o||1,width:(a||{width:100}).width}),i.set(e[0],(o||0)+1)}),a})(m,c,!!l):[],h=t.compose(e=>(e.push({name:"sheetPr",children:[{name:"outlinePr",properties:{rawMap:{summaryBelow:0}}}]}),e),(e=>t=>{const r=e.reduce((e,t)=>t.outlineLevel&&t.outlineLevel>e?t.outlineLevel:e,0);return t.push({name:"sheetFormatPr",properties:{rawMap:{baseColWidth:10,defaultRowHeight:16,outlineLevelRow:r||void 0}}}),t})(m),(e=>t=>(e.length&&t.push({name:"cols",children:e.map(e=>rt.getTemplate(e))}),t))(c),((e,t)=>r=>(e.length&&r.push({name:"sheetData",children:e.map((e,r)=>nt.getTemplate(e,r,t))}),r))(m,a+1),(g=d,e=>(g.length&&e.push({name:"mergeCells",properties:{rawMap:{count:g.length}},children:g.map(e=>it.getTemplate(e))}),e)),(e=>t=>{const{top:r=.75,right:a=.7,bottom:o=.75,left:n=.7,header:i=.3,footer:s=.3}=e;return t.push({name:"pageMargins",properties:{rawMap:{bottom:o,footer:s,header:i,left:n,right:a,top:r}}}),t})(n),(e=>t=>{var r;return e&&t.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:(r=e.orientation,!r||"Portrait"!==r&&"Landscape"!==r?"portrait":r.toLocaleLowerCase()),paperSize:st(e.pageSize)}}}),t})(i),(e=>t=>{if(!e)return t;const r=null!=e.first?1:0,a=null!=e.even?1:0;return t.push({name:"headerFooter",properties:{rawMap:{differentFirst:r,differentOddEven:a}},children:pt(e)}),t})(s),(e=>t=>(ht.worksheetImages.get(e)&&t.push({name:"drawing",properties:{rawMap:{"r:id":"rId1"}}}),t))(a));var g;return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:h([])}}},ct={getTemplate(e){const{Id:t,Type:r,Target:a}=e;return{name:"Relationship",properties:{rawMap:{Id:t,Type:r,Target:a}}}}},dt={getTemplate:e=>({name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:e.map(e=>ct.getTemplate(e))})};class ht{static createExcel(e,t,r){return this.addSheetName(t),((e,t)=>{Ue=t,1===Ue&&Xe(),e.forEach(Ke)})(e,this.sheetNames.length),this.createWorksheet(t,r)}static buildImageMap(e,t,r,a,o){const n=this.sheetNames.length,i=this.images.get(e.id);e.position&&e.position.row&&e.position.column||(e.position||(e.position={}),e.position=Object.assign({},e.position,{row:t,column:a.indexOf(r)+1}));const s=e;if(((e,t)=>{const{colSpan:r,column:a}=e.position;if(e.width)if(r){const o=t.slice(a-1,a+r-1);let n=0;for(let t=0;t<o.length;t++){const r=o[t].getActualWidth();if(e.width<n+r){e.position.colSpan=t+1,e.totalWidth=e.width,e.width=e.totalWidth-n;break}n+=r}}else e.totalWidth=e.width})(s,a),((e,t)=>{const{rowSpan:r,row:a}=e.position;if(e.height)if(r){let n=0,i=0;for(let s=a;s<a+r;s++){const r=(o=O(s,t)||20,Math.round(96*o/72));if(e.height<n+r){e.position.rowSpan=i+1,e.totalHeight=e.height,e.height=e.totalHeight-n;break}n+=r,i++}}else e.totalHeight=e.height;var o})(s,o),i){const e=i.find(e=>e.sheetId===n);e?e.image.push(s):i.push({sheetId:n,image:[s]})}else this.images.set(s.id,[{sheetId:n,image:[s]}]),this.workbookImageIds.set(s.id,{type:s.imageType,index:this.workbookImageIds.size});this.buildSheetImageMap(n,s)}static buildSheetImageMap(e,t){let r=this.worksheetImageIds.get(e);r||(r=new Map,this.worksheetImageIds.set(e,r));const a=this.worksheetImages.get(e);a?(a.push(t),r.get(t.id)||r.set(t.id,{index:r.size,type:t.imageType})):(this.worksheetImages.set(e,[t]),r.set(t.id,{index:0,type:t.imageType}))}static addSheetName(e){const r=t.escapeString(e.name)||"";let a="";for(;-1!==this.sheetNames.indexOf(`${r}${a}`);)if(""===a)a="_1";else{const e=parseInt(a.slice(1),10);a="_"+(e+1)}e.name=`${r}${a}`,this.sheetNames.push(e.name)}static getStringPosition(e){return this.sharedStrings.has(e)?this.sharedStrings.get(e):(this.sharedStrings.set(e,this.sharedStrings.size),this.sharedStrings.size-1)}static resetFactory(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.sheetNames=[],this.factoryMode=e.SINGLE_SHEET}static createWorkbook(){return L(tt.getTemplate(this.sheetNames))}static createStylesheet(e){return L(qe.getTemplate(e))}static createSharedStrings(){return L(me.getTemplate(this.sharedStrings))}static createCore(e){return L(z.getTemplate(e))}static createContentTypes(e){return L(G.getTemplate(e))}static createRels(){const e=dt.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return L(e)}static createTheme(){return L(le.getTemplate())}static createWorkbookRels(e){const t=new Array(e).fill(void 0).map((e,t)=>({Id:"rId"+(t+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:`worksheets/sheet${t+1}.xml`})),r=dt.getTemplate([...t,{Id:"rId"+(e+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:"rId"+(e+2),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:"rId"+(e+3),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]);return L(r)}static createDrawing(e){return L(Y.getTemplate({sheetIndex:e}))}static createDrawingRel(e){const t=this.worksheetImageIds.get(e),r=[];return t.forEach((e,t)=>{r.push({Id:"rId"+(e.index+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/image${this.workbookImageIds.get(t).index+1}.${e.type}`})}),L(dt.getTemplate(r))}static createWorksheetDrawingRel(e){const t=dt.getTemplate([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/drawing${e+1}.xml`}]);return L(t)}static createWorksheet(e,t){return L(mt.getTemplate({worksheet:e,currentSheet:this.sheetNames.length-1,config:t}))}}ht.sharedStrings=new Map,ht.sheetNames=[],ht.images=new Map,ht.worksheetImages=new Map,ht.workbookImageIds=new Map,ht.worksheetImageIds=new Map,ht.factoryMode=e.SINGLE_SHEET;class gt extends B{createExcel(e){const{excelStyles:t,config:r}=this;return ht.createExcel(t,e,r)}getDataTypeForValue(e){return void 0===e?"empty":this.isNumerical(e)?"n":"s"}getType(e,t,r){if(this.isFormula(r))return"f";if(t&&t.dataType)switch(t.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:console.warn(`AG Grid: Unrecognized data type for excel export [${t.id}.dataType=${t.dataType}]`)}return e}addImage(e,t,r){if(!this.config.addImageToCell)return;const a=this.config.addImageToCell(e,t,r);return a?(ht.buildImageMap(a.image,e,t,this.columnsToExport,this.config.rowHeight),a):void 0}createCell(e,t,r,a){const o=this.getStyleById(e);!(null==o?void 0:o.dataType)&&"s"===t&&a&&(r=a);const n=this.getType(t,o,r)||t;return{styleId:o?e:void 0,data:{type:n,value:this.getCellValue(n,r)}}}createMergedCell(e,t,r,a){const o=null==r?"":r;return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:"s"===t?ht.getStringPosition(o).toString():r},mergeAcross:a}}getCellValue(e,t){if(null==t)return ht.getStringPosition("").toString();switch(e){case"s":return""===t?"":ht.getStringPosition(t).toString();case"f":return t.slice(1);case"n":return Number(t).toString();default:return t}}}var ut=function(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i};const ft=e=>{const{data:t,fontSize:r=11,author:a="AG Grid"}=e,o=ht.images.size>0;if(c.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]),o){c.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);let e=0;ht.images.forEach(t=>{const r=t[0].image[0],a=r.imageType;c.addFile(`xl/media/image${++e}.${a}`,r.base64,!0)})}if(!t||0===t.length)return console.warn("AG Grid: Invalid params supplied to getMultipleSheetsAsExcel() - `ExcelExportParams.data` is empty."),void ht.resetFactory();const n=t.length;let i=0;t.forEach((e,t)=>{c.addFile(`xl/worksheets/sheet${t+1}.xml`,e),o&&ht.worksheetImages.get(t)&&yt(t,i++)}),c.addFile("xl/workbook.xml",ht.createWorkbook()),c.addFile("xl/styles.xml",ht.createStylesheet(r)),c.addFile("xl/sharedStrings.xml",ht.createSharedStrings()),c.addFile("xl/theme/theme1.xml",ht.createTheme()),c.addFile("xl/_rels/workbook.xml.rels",ht.createWorkbookRels(n)),c.addFile("docProps/core.xml",ht.createCore(a)),c.addFile("[Content_Types].xml",ht.createContentTypes(n)),c.addFile("_rels/.rels",ht.createRels()),ht.resetFactory();const s=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return c.getContent(s)},xt=e=>{const{fileName:t="export.xlsx"}=e,r=ft(e);r&&d.download(t,r)},yt=(e,t)=>{const r=`xl/drawings/drawing${t+1}.xml`,a=`xl/drawings/_rels/drawing${t+1}.xml.rels`,o=`xl/worksheets/_rels/sheet${e+1}.xml.rels`;c.addFile(a,ht.createDrawingRel(e)),c.addFile(r,ht.createDrawing(e)),c.addFile(o,ht.createWorksheetDrawingRel(t))};let wt=class extends h{constructor(){super(...arguments),this.exportMode="xlsx"}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsService:this.gridOptionsService})}getMergedParams(e){const t=this.gridOptionsService.get("defaultExcelExportParams");return Object.assign({},t,e)}getData(e){return this.setExportMode(e.exportMode||"xlsx"),super.getData(e)}export(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";const t=this.getMergedParams(e),r=this.getData(t),a={data:[r],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType},o=this.packageFile(a);return o&&d.download(this.getFileName(t.fileName),o),r}exportDataAsExcel(e){return this.export(e)}getDataAsExcel(e){const t=this.getMergedParams(e),r=this.getData(t);if(e&&"xml"===e.exportMode)return r;const a={data:[r],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(a)}setFactoryMode(e,t="xlsx"){("xlsx"===t?ht:N).factoryMode=e}getFactoryMode(e){return("xlsx"===e?ht:N).factoryMode}getSheetDataForExcel(e){const t=this.getMergedParams(e);return this.getData(t)}getMultipleSheetsAsExcel(e){return ft(e)}exportMultipleSheetsAsExcel(e){return xt(e)}getDefaultFileName(){return"export."+this.getExportMode()}getDefaultFileExtension(){return this.getExportMode()}createSerializingSession(e){const{columnModel:r,valueService:a,gridOptionsService:o,valueFormatterService:n,valueParserService:i}=this,s="xlsx"===this.getExportMode();let l="ag-grid";null!=e.sheetName&&(l=t.utf8_encode(e.sheetName.toString().substr(0,31)));const p=Object.assign(Object.assign({},e),{sheetName:l,columnModel:r,valueService:a,gridOptionsService:o,valueFormatterService:n,valueParserService:i,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:this.gridOptionsService.get("excelStyles")||[],styleLinker:this.styleLinker.bind(this)});return new(s?gt:H)(p)}styleLinker(e){const{rowType:t,rowIndex:r,value:a,column:o,columnGroup:i,node:s}=e,l=t===m.HEADER,p=t===m.HEADER_GROUPING,c=l?o:i;let d=[];if(l||p)return d.push("header"),p&&d.push("headerGroup"),c&&(d=d.concat(n.getHeaderClassesFromColDef(c.getDefinition(),this.gridOptionsService,o||null,i||null))),d;const h=this.gridOptionsService.get("excelStyles"),g=["cell"];if(!h||!h.length)return g;const u=h.map(e=>e.id);return this.stylingService.processAllCellClasses(o.getDefinition(),{value:a,data:s.data,node:s,colDef:o.getDefinition(),column:o,rowIndex:r,api:this.gridOptionsService.api,columnApi:this.gridOptionsService.columnApi,context:this.gridOptionsService.context},e=>{u.indexOf(e)>-1&&g.push(e)}),g.sort((e,t)=>u.indexOf(e)<u.indexOf(t)?-1:1)}isExportSuppressed(){return this.gridOptionsService.is("suppressExcelExport")}setExportMode(e){this.exportMode=e}getExportMode(){return this.exportMode}packageFile(e){if("xml"===this.getExportMode()){const t=e.mimeType||"application/vnd.ms-excel";return new Blob(["\ufeff",e.data[0]],{type:t})}return ft(e)}};ut([r("columnModel")],wt.prototype,"columnModel",void 0),ut([r("valueService")],wt.prototype,"valueService",void 0),ut([r("stylingService")],wt.prototype,"stylingService",void 0),ut([r("gridSerializer")],wt.prototype,"gridSerializer",void 0),ut([r("gridOptionsService")],wt.prototype,"gridOptionsService",void 0),ut([r("valueFormatterService")],wt.prototype,"valueFormatterService",void 0),ut([r("valueParserService")],wt.prototype,"valueParserService",void 0),ut([a],wt.prototype,"postConstruct",null),wt=ut([o("excelCreator")],wt);const Tt={version:"30.0.0",moduleName:i.ExcelExportModule,beans:[wt,g,u],dependantModules:[f,s]};export{Tt as ExcelExportModule,xt as exportMultipleSheetsAsExcel,ft as getMultipleSheetsAsExcel};