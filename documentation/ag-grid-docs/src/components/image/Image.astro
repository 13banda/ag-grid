---
import { Image } from './Image';
import { DOCS_PAGE_NAME_PATH_INDEX } from '@features/docs/constants';
import { getPageImages } from '@features/docs/utils/filesData';

interface Props {
    pageName?: string;
    imagePath: string;
    alt: string;
    width?: string;
    height?: string;
    minWidth?: string;
    maxWidth?: string;
}

const { pageName: propPageName, imagePath, alt, ...props } = Astro.props as Props;

const pathSegments = Astro.url.pathname.split('/');
const pageName = propPageName ? propPageName : pathSegments[DOCS_PAGE_NAME_PATH_INDEX];

const { imageSrc } = await getPageImages({
    pageName,
    imagePath,
});
---

{
    imageSrc && (
        <Image
            client:load
            alt={alt}
            src={imageSrc}
            {...props}
        />
    )
}
